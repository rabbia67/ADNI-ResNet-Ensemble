2025-12-20 17:37:11,079 - INFO - ================================================================================
2025-12-20 17:37:11,081 - INFO - Memory-Efficient Alzheimer's Classification
2025-12-20 17:37:11,081 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2025-12-20 17:37:11,081 - INFO - ================================================================================
2025-12-20 17:37:11,081 - INFO - Configuration:
2025-12-20 17:37:11,081 - INFO -   • Image Size: 224x224
2025-12-20 17:37:11,081 - INFO -   • Batch Size: 16
2025-12-20 17:37:11,081 - INFO -   • K-Folds: 5
2025-12-20 17:37:11,081 - INFO -   • Epochs: 50
2025-12-20 17:37:11,081 - INFO -   • Sample Dataset: False
2025-12-20 17:37:11,081 - INFO - 
================================================================================
2025-12-20 17:37:11,081 - INFO - Starting 5-Fold Cross-Validation
2025-12-20 17:37:11,081 - INFO - ================================================================================

2025-12-20 17:37:11,081 - INFO - Collecting file paths from: C:\Users\Rabbia\Desktop\ALzhimer\Combined Dataset\train
2025-12-20 17:37:11,317 - INFO - Found 10240 images from 4 classes
2025-12-20 17:37:11,333 - INFO -   • Mild Impairment: 2560 images
2025-12-20 17:37:11,333 - INFO -   • Moderate Impairment: 2560 images
2025-12-20 17:37:11,333 - INFO -   • No Impairment: 2560 images
2025-12-20 17:37:11,333 - INFO -   • Very Mild Impairment: 2560 images
2025-12-20 17:37:11,338 - INFO - 
============================================================
2025-12-20 17:37:11,340 - INFO - Training Fold 1/5
2025-12-20 17:37:11,340 - INFO - ============================================================
2025-12-20 17:37:11,927 - WARNING - From C:\Users\Rabbia\anaconda3\envs\dis\lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-12-20 17:37:12,182 - INFO - Training samples: 8192
2025-12-20 17:37:12,182 - INFO - Validation samples: 2048
2025-12-20 17:37:12,189 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2025-12-20 17:37:12,189 - INFO - Building model architecture...
2025-12-20 17:37:13,637 - INFO - Model created with 188 layers
2025-12-20 17:37:13,637 - INFO - Trainable parameters: 25,305,860
2025-12-20 17:37:13,653 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2025-12-20 21:05:27,719 - INFO - 
Phase 2: Fine-tuning entire model...
2025-12-20 23:25:31,998 - INFO - 
Evaluating fold performance...
2025-12-20 23:27:31,595 - INFO - 
Fold 1 Results:
2025-12-20 23:27:31,595 - INFO -   • Accuracy:  0.8325
2025-12-20 23:27:31,596 - INFO -   • Precision: 0.8454
2025-12-20 23:27:31,596 - INFO -   • Recall:    0.8325
2025-12-20 23:27:31,596 - INFO -   • F1-Score:  0.8273
2025-12-20 23:27:31,596 - INFO -   • Kappa:     0.7767
2025-12-20 23:27:34,733 - INFO - Model saved: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\models\model_fold_1.keras
2025-12-20 23:27:38,710 - INFO - 
============================================================
2025-12-20 23:27:38,719 - INFO - Training Fold 2/5
2025-12-20 23:27:38,720 - INFO - ============================================================
2025-12-20 23:27:39,440 - INFO - Training samples: 8192
2025-12-20 23:27:39,440 - INFO - Validation samples: 2048
2025-12-20 23:27:39,452 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2025-12-20 23:27:39,452 - INFO - Building model architecture...
2025-12-20 23:27:41,610 - INFO - Model created with 188 layers
2025-12-20 23:27:41,615 - INFO - Trainable parameters: 25,305,860
2025-12-20 23:27:41,634 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2025-12-21 09:48:24,643 - INFO - ================================================================================
2025-12-21 09:48:24,643 - INFO - Memory-Efficient Alzheimer's Classification
2025-12-21 09:48:24,643 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2025-12-21 09:48:24,643 - INFO - ================================================================================
2025-12-21 09:48:24,643 - INFO - Configuration:
2025-12-21 09:48:24,643 - INFO -   • Image Size: 224x224
2025-12-21 09:48:24,643 - INFO -   • Batch Size: 16
2025-12-21 09:48:24,643 - INFO -   • K-Folds: 5
2025-12-21 09:48:24,645 - INFO -   • Epochs: 50
2025-12-21 09:48:24,645 - INFO -   • Sample Dataset: False
2025-12-21 09:48:24,645 - INFO - 
================================================================================
2025-12-21 09:48:24,645 - INFO - Starting 5-Fold Cross-Validation
2025-12-21 09:48:24,645 - INFO - ================================================================================

2025-12-21 09:48:24,645 - INFO - Collecting file paths from: C:\Users\Rabbia\Desktop\ALzhimer\Combined Dataset\train
2025-12-21 09:48:24,856 - INFO - Found 10240 images from 4 classes
2025-12-21 09:48:24,856 - INFO -   • Mild Impairment: 2560 images
2025-12-21 09:48:24,856 - INFO -   • Moderate Impairment: 2560 images
2025-12-21 09:48:24,856 - INFO -   • No Impairment: 2560 images
2025-12-21 09:48:24,856 - INFO -   • Very Mild Impairment: 2560 images
2025-12-21 09:48:24,874 - INFO - 
============================================================
2025-12-21 09:48:24,874 - INFO - Training Fold 1/5
2025-12-21 09:48:24,874 - INFO - ============================================================
2025-12-21 09:48:26,023 - WARNING - From C:\Users\Rabbia\anaconda3\envs\dis\lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-12-21 09:48:26,448 - INFO - Training samples: 8192
2025-12-21 09:48:26,448 - INFO - Validation samples: 2048
2025-12-21 09:48:26,469 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2025-12-21 09:48:26,472 - INFO - Building model architecture...
2025-12-21 09:48:28,616 - INFO - Model created with 188 layers
2025-12-21 09:48:28,618 - INFO - Trainable parameters: 25,305,860
2025-12-21 09:48:28,625 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2025-12-21 13:04:57,834 - INFO - 
Phase 2: Fine-tuning entire model...
2025-12-21 15:21:46,943 - INFO - 
Evaluating fold performance...
2025-12-21 15:23:29,999 - INFO - 
Fold 1 Results:
2025-12-21 15:23:30,001 - INFO -   • Accuracy:  0.8335
2025-12-21 15:23:30,001 - INFO -   • Precision: 0.8415
2025-12-21 15:23:30,001 - INFO -   • Recall:    0.8335
2025-12-21 15:23:30,001 - INFO -   • F1-Score:  0.8274
2025-12-21 15:23:30,001 - INFO -   • Kappa:     0.7780
2025-12-21 15:23:31,993 - INFO - Model saved: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\models\model_fold_1.keras
2025-12-21 15:23:32,893 - INFO - 
============================================================
2025-12-21 15:23:32,894 - INFO - Training Fold 2/5
2025-12-21 15:23:32,894 - INFO - ============================================================
2025-12-21 15:23:33,386 - INFO - Training samples: 8192
2025-12-21 15:23:33,386 - INFO - Validation samples: 2048
2025-12-21 15:23:33,395 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2025-12-21 15:23:33,395 - INFO - Building model architecture...
2025-12-21 15:23:35,023 - INFO - Model created with 188 layers
2025-12-21 15:23:35,026 - INFO - Trainable parameters: 25,305,860
2025-12-21 15:23:35,040 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2025-12-21 18:44:19,297 - INFO - 
Phase 2: Fine-tuning entire model...
2025-12-21 21:01:54,750 - INFO - 
Evaluating fold performance...
2025-12-21 21:03:46,448 - INFO - 
Fold 2 Results:
2025-12-21 21:03:46,448 - INFO -   • Accuracy:  0.8228
2025-12-21 21:03:46,449 - INFO -   • Precision: 0.8306
2025-12-21 21:03:46,449 - INFO -   • Recall:    0.8228
2025-12-21 21:03:46,449 - INFO -   • F1-Score:  0.8214
2025-12-21 21:03:46,449 - INFO -   • Kappa:     0.7637
2025-12-21 21:03:49,547 - INFO - Model saved: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\models\model_fold_2.keras
2025-12-21 21:03:52,651 - INFO - 
============================================================
2025-12-21 21:03:52,652 - INFO - Training Fold 3/5
2025-12-21 21:03:52,652 - INFO - ============================================================
2025-12-21 21:03:53,854 - INFO - Training samples: 8192
2025-12-21 21:03:53,854 - INFO - Validation samples: 2048
2025-12-21 21:03:53,864 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2025-12-21 21:03:53,865 - INFO - Building model architecture...
2025-12-21 21:03:56,460 - INFO - Model created with 188 layers
2025-12-21 21:03:56,464 - INFO - Trainable parameters: 25,305,860
2025-12-21 21:03:56,488 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2025-12-22 00:26:25,635 - INFO - 
Phase 2: Fine-tuning entire model...
2025-12-22 02:28:11,022 - INFO - 
Evaluating fold performance...
2025-12-22 02:29:54,812 - INFO - 
Fold 3 Results:
2025-12-22 02:29:54,813 - INFO -   • Accuracy:  0.8252
2025-12-22 02:29:54,813 - INFO -   • Precision: 0.8429
2025-12-22 02:29:54,813 - INFO -   • Recall:    0.8252
2025-12-22 02:29:54,814 - INFO -   • F1-Score:  0.8176
2025-12-22 02:29:54,814 - INFO -   • Kappa:     0.7669
2025-12-22 02:30:01,023 - INFO - Model saved: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\models\model_fold_3.keras
2025-12-22 02:30:03,075 - INFO - 
============================================================
2025-12-22 02:30:03,076 - INFO - Training Fold 4/5
2025-12-22 02:30:03,076 - INFO - ============================================================
2025-12-22 02:30:03,831 - INFO - Training samples: 8192
2025-12-22 02:30:03,831 - INFO - Validation samples: 2048
2025-12-22 02:30:03,839 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2025-12-22 02:30:03,839 - INFO - Building model architecture...
2025-12-22 02:30:05,157 - INFO - Model created with 188 layers
2025-12-22 02:30:05,158 - INFO - Trainable parameters: 25,305,860
2025-12-22 02:30:05,173 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2025-12-22 05:32:33,858 - INFO - 
Phase 2: Fine-tuning entire model...
2025-12-22 07:33:03,898 - INFO - 
Evaluating fold performance...
2025-12-22 07:34:51,126 - INFO - 
Fold 4 Results:
2025-12-22 07:34:51,128 - INFO -   • Accuracy:  0.8345
2025-12-22 07:34:51,128 - INFO -   • Precision: 0.8377
2025-12-22 07:34:51,129 - INFO -   • Recall:    0.8345
2025-12-22 07:34:51,129 - INFO -   • F1-Score:  0.8308
2025-12-22 07:34:51,129 - INFO -   • Kappa:     0.7793
2025-12-22 07:34:53,217 - INFO - Model saved: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\models\model_fold_4.keras
2025-12-22 07:34:55,709 - INFO - 
============================================================
2025-12-22 07:34:55,709 - INFO - Training Fold 5/5
2025-12-22 07:34:55,709 - INFO - ============================================================
2025-12-22 07:34:56,681 - INFO - Training samples: 8192
2025-12-22 07:34:56,682 - INFO - Validation samples: 2048
2025-12-22 07:34:56,690 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2025-12-22 07:34:56,690 - INFO - Building model architecture...
2025-12-22 07:34:58,008 - INFO - Model created with 188 layers
2025-12-22 07:34:58,010 - INFO - Trainable parameters: 25,305,860
2025-12-22 07:34:58,026 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2025-12-22 10:36:40,179 - INFO - 
Phase 2: Fine-tuning entire model...
2025-12-22 12:38:49,697 - INFO - 
Evaluating fold performance...
2025-12-22 12:40:31,878 - INFO - 
Fold 5 Results:
2025-12-22 12:40:31,878 - INFO -   • Accuracy:  0.8193
2025-12-22 12:40:31,879 - INFO -   • Precision: 0.8224
2025-12-22 12:40:31,879 - INFO -   • Recall:    0.8193
2025-12-22 12:40:31,879 - INFO -   • F1-Score:  0.8148
2025-12-22 12:40:31,879 - INFO -   • Kappa:     0.7591
2025-12-22 12:40:34,087 - INFO - Model saved: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\models\model_fold_5.keras
2025-12-22 12:40:38,935 - INFO - 
============================================================
2025-12-22 12:40:38,936 - INFO - K-Fold Cross-Validation Summary
2025-12-22 12:40:38,936 - INFO - ============================================================
2025-12-22 12:40:38,936 - INFO - Average Accuracy:  0.8271 ± 0.0060
2025-12-22 12:40:38,937 - INFO - Average Precision: 0.8350
2025-12-22 12:40:38,937 - INFO - Average Recall:    0.8271
2025-12-22 12:40:38,937 - INFO - Average F1-Score:  0.8224 ± 0.0060
2025-12-22 12:40:38,937 - INFO - Average Kappa:     0.7694
2025-12-22 12:40:38,941 - INFO - Results saved to: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\metrics\kfold_results.json
2025-12-22 12:40:38,941 - INFO - Generating K-Fold visualization plots...
2025-12-22 12:40:40,902 - INFO - K-fold analysis plot saved: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\metrics\kfold_analysis.png
2025-12-22 12:40:40,913 - INFO - 
================================================================================
2025-12-22 12:40:40,913 - INFO - Evaluating on Test Set
2025-12-22 12:40:40,913 - INFO - ================================================================================

2025-12-22 12:40:41,062 - INFO - 
============================================================
2025-12-22 12:40:41,062 - INFO - Making Ensemble Predictions
2025-12-22 12:40:41,062 - INFO - ============================================================
2025-12-22 12:40:41,062 - INFO - Combining predictions from 5 models...
2025-12-22 12:40:41,062 - INFO - Loading model 1/5: model_fold_1.keras
2025-12-22 12:41:48,932 - INFO - Loading model 2/5: model_fold_2.keras
2025-12-22 12:42:52,692 - INFO - Loading model 3/5: model_fold_3.keras
2025-12-22 12:43:56,676 - INFO - Loading model 4/5: model_fold_4.keras
2025-12-22 12:45:00,349 - INFO - Loading model 5/5: model_fold_5.keras
2025-12-22 12:46:07,984 - INFO - Ensemble prediction shape: (1183, 4)
2025-12-22 12:46:07,995 - INFO - 
============================================================
2025-12-22 12:46:07,995 - INFO - ENSEMBLE TEST RESULTS
2025-12-22 12:46:07,995 - INFO - ============================================================
2025-12-22 12:46:07,996 - INFO - Accuracy:          0.7101 (71.01%)
2025-12-22 12:46:07,996 - INFO - Precision (Macro): 0.7455
2025-12-22 12:46:07,996 - INFO - Recall (Macro):    0.7647
2025-12-22 12:46:07,996 - INFO - F1-Score (Macro):  0.7253
2025-12-22 12:46:07,997 - INFO - Cohen's Kappa:     0.4745
2025-12-22 12:46:07,997 - INFO - MCC:               0.5017
2025-12-22 12:46:08,004 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.43      0.73      0.54        83
 Moderate Impairment       1.00      1.00      1.00        12
       No Impairment       0.72      0.91      0.80       640
Very Mild Impairment       0.83      0.42      0.56       448

            accuracy                           0.71      1183
           macro avg       0.75      0.76      0.73      1183
        weighted avg       0.75      0.71      0.69      1183

2025-12-22 12:46:08,006 - INFO - Metrics saved to: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\metrics\ensemble_results.json
2025-12-22 12:46:08,752 - INFO - Confusion matrix saved: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2025-12-22 12:46:08,753 - INFO - 
================================================================================
2025-12-22 12:46:08,753 - INFO - Generating Grad-CAM++ Visualizations
2025-12-22 12:46:08,753 - INFO - ================================================================================

2025-12-22 12:46:10,881 - INFO - Processing 3 images for class: Mild Impairment
2025-12-22 12:46:19,693 - INFO - Processing 3 images for class: Moderate Impairment
2025-12-22 12:46:25,771 - INFO - Processing 3 images for class: No Impairment
2025-12-22 12:46:31,878 - INFO - Processing 3 images for class: Very Mild Impairment
2025-12-22 12:46:38,689 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\gradcam_plus_plus
2025-12-22 12:46:40,186 - INFO - 
================================================================================
2025-12-22 12:46:40,187 - INFO - Starting SHAP Analysis
2025-12-22 12:46:40,187 - INFO - ================================================================================

2025-12-22 12:46:40,187 - INFO - 
============================================================
2025-12-22 12:46:40,187 - INFO - Starting SHAP Analysis
2025-12-22 12:46:40,187 - INFO - ============================================================
2025-12-22 12:46:40,188 - INFO - Loading model from: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\models\model_fold_1.keras
2025-12-22 12:46:42,565 - INFO - Collecting file paths from: C:\Users\Rabbia\Desktop\ALzhimer\Combined Dataset\test
2025-12-22 12:46:42,574 - INFO - Found 1183 images from 4 classes
2025-12-22 12:46:42,575 - INFO -   • Mild Impairment: 83 images
2025-12-22 12:46:42,575 - INFO -   • Moderate Impairment: 12 images
2025-12-22 12:46:42,575 - INFO -   • No Impairment: 640 images
2025-12-22 12:46:42,575 - INFO -   • Very Mild Impairment: 448 images
2025-12-22 12:46:42,578 - INFO - Loading 50 background samples...
2025-12-22 12:46:42,653 - INFO - Loaded 50 background samples
2025-12-22 12:46:42,653 - INFO - Loading 10 test samples...
2025-12-22 12:46:42,670 - INFO - Loaded 10 test samples
2025-12-22 12:46:42,671 - INFO - Creating SHAP DeepExplainer (this may take a few minutes)...
2025-12-22 12:47:06,872 - INFO - Calculating SHAP values...
2025-12-22 12:47:30,826 - ERROR - Error during SHAP analysis: in user code:

    File "C:\Users\Rabbia\anaconda3\envs\dis\lib\site-packages\shap\explainers\_deep\deep_tf.py", line 265, in grad_graph  *
        x_grad = tape.gradient(out, shap_rAnD)

    LookupError: gradient registry has no entry for: shap_BatchMatMulV2

2025-12-22 12:47:34,784 - INFO - 
================================================================================
2025-12-22 12:47:34,785 - INFO - ANALYSIS COMPLETE!
2025-12-22 12:47:34,785 - INFO - ================================================================================

2025-12-22 12:47:34,786 - INFO - All results saved to: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced

2025-12-22 12:47:34,786 - INFO - Generated Files:
2025-12-22 12:47:34,787 - INFO -   K-Fold Analysis:  C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\metrics\kfold_analysis.png
2025-12-22 12:47:34,787 - INFO -   K-Fold Results:   C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\metrics\kfold_results.json
2025-12-22 12:47:34,787 - INFO -   Ensemble Results: C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\metrics\ensemble_results.json
2025-12-22 12:47:34,787 - INFO -   Grad-CAM++ Viz:   C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\gradcam_plus_plus/
2025-12-22 12:47:34,787 - INFO -   SHAP Analysis:    C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\shap_analysis/
2025-12-22 12:47:34,788 - INFO -   Trained Models:   C:\Users\Rabbia\Desktop\ALzhimer\results_advanced\models/
2025-12-22 12:47:34,788 - INFO - 
================================================================================

2026-01-02 09:50:14,157 - INFO - ================================================================================
2026-01-02 09:50:14,157 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-02 09:50:14,161 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-02 09:50:14,161 - INFO - ================================================================================
2026-01-02 09:50:14,161 - INFO - Configuration:
2026-01-02 09:50:14,161 - INFO -   • Image Size: 224x224
2026-01-02 09:50:14,161 - INFO -   • Batch Size: 16
2026-01-02 09:50:14,161 - INFO -   • K-Folds: 5
2026-01-02 09:50:14,161 - INFO -   • Epochs: 50
2026-01-02 09:50:14,164 - INFO - No GPU detected. Using CPU.
2026-01-02 09:50:14,164 - INFO - Starting K-Fold Cross-Validation...
2026-01-02 09:50:14,164 - INFO - 
================================================================================
2026-01-02 09:50:14,164 - INFO - Starting 5-Fold Cross-Validation
2026-01-02 09:50:14,164 - INFO - ================================================================================

2026-01-02 09:50:14,166 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\ALzhimer\Combined Dataset\train
2026-01-02 09:50:14,234 - INFO - Found 10240 images from 4 classes
2026-01-02 09:50:14,234 - INFO -   • Mild Impairment: 2560 images
2026-01-02 09:50:14,234 - INFO -   • Moderate Impairment: 2560 images
2026-01-02 09:50:14,234 - INFO -   • No Impairment: 2560 images
2026-01-02 09:50:14,234 - INFO -   • Very Mild Impairment: 2560 images
2026-01-02 09:50:14,241 - INFO - 
============================================================
2026-01-02 09:50:14,241 - INFO - Training Fold 1/5
2026-01-02 09:50:14,241 - INFO - ============================================================
2026-01-02 09:50:14,814 - WARNING - From C:\Users\Lab1\miniconda3\envs\dis\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2026-01-02 09:50:15,080 - INFO - Training samples: 8192
2026-01-02 09:50:15,080 - INFO - Validation samples: 2048
2026-01-02 09:50:15,084 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2026-01-02 09:50:15,084 - INFO - Building model architecture...
2026-01-02 09:50:37,612 - INFO - Model created with 188 layers
2026-01-02 09:50:37,614 - INFO - Trainable parameters: 25,305,860
2026-01-02 09:50:37,620 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-02 10:46:40,295 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-02 11:19:08,850 - INFO - 
Evaluating fold performance...
2026-01-02 11:19:35,084 - INFO - 
Fold 1 Results:
2026-01-02 11:19:35,084 - INFO -   • Accuracy:  0.8232
2026-01-02 11:19:35,084 - INFO -   • Precision: 0.8442
2026-01-02 11:19:35,084 - INFO -   • Recall:    0.8232
2026-01-02 11:19:35,084 - INFO -   • F1-Score:  0.8178
2026-01-02 11:19:35,084 - INFO -   • Kappa:     0.7643
2026-01-02 11:19:36,385 - INFO - Model saved: C:\Users\Lab1\Desktop\ALzhimer\results_advanced\models\model_fold_1.keras
2026-01-02 11:19:36,981 - INFO - 
============================================================
2026-01-02 11:19:36,981 - INFO - Training Fold 2/5
2026-01-02 11:19:36,983 - INFO - ============================================================
2026-01-02 11:19:37,541 - INFO - Training samples: 8192
2026-01-02 11:19:37,541 - INFO - Validation samples: 2048
2026-01-02 11:19:37,541 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2026-01-02 11:19:37,541 - INFO - Building model architecture...
2026-01-02 11:19:38,717 - INFO - Model created with 188 layers
2026-01-02 11:19:38,720 - INFO - Trainable parameters: 25,305,860
2026-01-02 11:19:38,720 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-02 12:16:07,181 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-02 12:47:47,084 - INFO - 
Evaluating fold performance...
2026-01-02 12:48:14,020 - INFO - 
Fold 2 Results:
2026-01-02 12:48:14,020 - INFO -   • Accuracy:  0.8350
2026-01-02 12:48:14,020 - INFO -   • Precision: 0.8414
2026-01-02 12:48:14,020 - INFO -   • Recall:    0.8350
2026-01-02 12:48:14,020 - INFO -   • F1-Score:  0.8309
2026-01-02 12:48:14,020 - INFO -   • Kappa:     0.7799
2026-01-02 12:48:15,341 - INFO - Model saved: C:\Users\Lab1\Desktop\ALzhimer\results_advanced\models\model_fold_2.keras
2026-01-02 12:48:16,241 - INFO - 
============================================================
2026-01-02 12:48:16,241 - INFO - Training Fold 3/5
2026-01-02 12:48:16,241 - INFO - ============================================================
2026-01-02 12:48:16,970 - INFO - Training samples: 8192
2026-01-02 12:48:16,970 - INFO - Validation samples: 2048
2026-01-02 12:48:16,981 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2026-01-02 12:48:16,981 - INFO - Building model architecture...
2026-01-02 12:48:18,141 - INFO - Model created with 188 layers
2026-01-02 12:48:18,141 - INFO - Trainable parameters: 25,305,860
2026-01-02 12:48:18,162 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-02 13:45:48,499 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-02 14:19:24,557 - INFO - 
Evaluating fold performance...
2026-01-02 14:19:53,158 - INFO - 
Fold 3 Results:
2026-01-02 14:19:53,159 - INFO -   • Accuracy:  0.8491
2026-01-02 14:19:53,163 - INFO -   • Precision: 0.8483
2026-01-02 14:19:53,163 - INFO -   • Recall:    0.8491
2026-01-02 14:19:53,164 - INFO -   • F1-Score:  0.8473
2026-01-02 14:19:53,164 - INFO -   • Kappa:     0.7988
2026-01-02 14:19:54,523 - INFO - Model saved: C:\Users\Lab1\Desktop\ALzhimer\results_advanced\models\model_fold_3.keras
2026-01-02 14:19:55,740 - INFO - 
============================================================
2026-01-02 14:19:55,740 - INFO - Training Fold 4/5
2026-01-02 14:19:55,743 - INFO - ============================================================
2026-01-02 14:19:56,792 - INFO - Training samples: 8192
2026-01-02 14:19:56,793 - INFO - Validation samples: 2048
2026-01-02 14:19:56,800 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2026-01-02 14:19:56,801 - INFO - Building model architecture...
2026-01-02 14:19:58,032 - INFO - Model created with 188 layers
2026-01-02 14:19:58,034 - INFO - Trainable parameters: 25,305,860
2026-01-02 14:19:58,044 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-02 15:30:46,987 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-02 16:04:01,676 - INFO - 
Evaluating fold performance...
2026-01-02 16:04:29,714 - INFO - 
Fold 4 Results:
2026-01-02 16:04:29,719 - INFO -   • Accuracy:  0.8076
2026-01-02 16:04:29,720 - INFO -   • Precision: 0.8167
2026-01-02 16:04:29,720 - INFO -   • Recall:    0.8076
2026-01-02 16:04:29,720 - INFO -   • F1-Score:  0.8026
2026-01-02 16:04:29,720 - INFO -   • Kappa:     0.7435
2026-01-02 16:04:31,040 - INFO - Model saved: C:\Users\Lab1\Desktop\ALzhimer\results_advanced\models\model_fold_4.keras
2026-01-02 16:04:32,438 - INFO - 
============================================================
2026-01-02 16:04:32,438 - INFO - Training Fold 5/5
2026-01-02 16:04:32,440 - INFO - ============================================================
2026-01-02 16:04:33,671 - INFO - Training samples: 8192
2026-01-02 16:04:33,672 - INFO - Validation samples: 2048
2026-01-02 16:04:33,678 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2026-01-02 16:04:33,678 - INFO - Building model architecture...
2026-01-02 16:04:34,834 - INFO - Model created with 188 layers
2026-01-02 16:04:34,835 - INFO - Trainable parameters: 25,305,860
2026-01-02 16:04:34,848 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-02 16:47:09,970 - INFO - ================================================================================
2026-01-02 16:47:09,970 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-02 16:47:09,970 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-02 16:47:09,986 - INFO - ================================================================================
2026-01-02 16:47:09,986 - INFO - Configuration:
2026-01-02 16:47:09,986 - INFO -   • Image Size: 224x224
2026-01-02 16:47:09,986 - INFO -   • Batch Size: 16
2026-01-02 16:47:09,986 - INFO -   • K-Folds: 5
2026-01-02 16:47:09,986 - INFO -   • Epochs: 50
2026-01-02 16:47:09,986 - INFO - No GPU detected. Using CPU.
2026-01-02 16:47:09,986 - INFO - Starting K-Fold Cross-Validation...
2026-01-02 16:47:09,986 - INFO - 
================================================================================
2026-01-02 16:47:09,986 - INFO - Starting 5-Fold Cross-Validation
2026-01-02 16:47:09,986 - INFO - ================================================================================

2026-01-02 16:47:09,986 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-02 16:47:10,048 - INFO - Found 10240 images from 4 classes
2026-01-02 16:47:10,048 - INFO -   • Mild Impairment: 2560 images
2026-01-02 16:47:10,048 - INFO -   • Moderate Impairment: 2560 images
2026-01-02 16:47:10,048 - INFO -   • No Impairment: 2560 images
2026-01-02 16:47:10,048 - INFO -   • Very Mild Impairment: 2560 images
2026-01-02 16:47:10,064 - INFO - 
============================================================
2026-01-02 16:47:10,064 - INFO - Training Fold 1/5
2026-01-02 16:47:10,064 - INFO - ============================================================
2026-01-02 16:47:10,720 - WARNING - From C:\Users\Lab1\miniconda3\envs\dis\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2026-01-02 16:47:11,001 - INFO - Training samples: 8192
2026-01-02 16:47:11,001 - INFO - Validation samples: 2048
2026-01-02 16:47:11,001 - INFO - Class weights: {0: np.float64(1.0), 1: np.float64(1.0), 2: np.float64(1.0), 3: np.float64(1.0)}
2026-01-02 16:47:11,001 - INFO - Building model architecture...
2026-01-02 16:47:12,454 - INFO - Model created with 188 layers
2026-01-02 16:47:12,454 - INFO - Trainable parameters: 25,305,860
2026-01-02 16:47:12,470 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 09:54:19,084 - INFO - ================================================================================
2026-01-05 09:54:19,084 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-05 09:54:19,089 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-05 09:54:19,089 - INFO - ================================================================================
2026-01-05 09:54:19,090 - INFO - Configuration:
2026-01-05 09:54:19,090 - INFO -   • Image Size: 224x224
2026-01-05 09:54:19,090 - INFO -   • Batch Size: 16
2026-01-05 09:54:19,092 - INFO -   • K-Folds: 5
2026-01-05 09:54:19,092 - INFO -   • Epochs: 50
2026-01-05 09:54:19,169 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-05 09:54:19,169 - INFO - Starting K-Fold Cross-Validation...
2026-01-05 09:54:19,169 - INFO - 
================================================================================
2026-01-05 09:54:19,169 - INFO - Starting 5-Fold Cross-Validation
2026-01-05 09:54:19,169 - INFO - ================================================================================

2026-01-05 09:54:19,169 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-05 09:54:19,234 - INFO - Found 10240 images from 4 classes
2026-01-05 09:54:19,234 - INFO -   • Mild Impairment: 2560 images
2026-01-05 09:54:19,234 - INFO -   • Moderate Impairment: 2560 images
2026-01-05 09:54:19,234 - INFO -   • No Impairment: 2560 images
2026-01-05 09:54:19,234 - INFO -   • Very Mild Impairment: 2560 images
2026-01-05 09:54:19,242 - INFO - 
============================================================
2026-01-05 09:54:19,242 - INFO - Training Fold 1/5
2026-01-05 09:54:19,242 - INFO - ============================================================
2026-01-05 09:54:19,345 - INFO - Training samples: 8192
2026-01-05 09:54:19,345 - INFO - Validation samples: 2048
2026-01-05 09:54:19,345 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 09:54:19,345 - INFO - Building model architecture...
2026-01-05 09:54:22,295 - INFO - Model created with 188 layers
2026-01-05 09:54:22,295 - INFO - Trainable parameters: 25,305,860
2026-01-05 09:54:22,295 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 10:25:21,517 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 10:40:02,894 - INFO - 
Evaluating fold performance...
2026-01-05 10:40:09,345 - INFO - 
Fold 1 Results:
2026-01-05 10:40:09,345 - INFO -   • Accuracy:  0.8237
2026-01-05 10:40:09,345 - INFO -   • Precision: 0.8473
2026-01-05 10:40:09,345 - INFO -   • Recall:    0.8237
2026-01-05 10:40:09,345 - INFO -   • F1-Score:  0.8132
2026-01-05 10:40:09,345 - INFO -   • Kappa:     0.7650
2026-01-05 10:40:09,945 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-05 10:40:10,169 - INFO - 
============================================================
2026-01-05 10:40:10,169 - INFO - Training Fold 2/5
2026-01-05 10:40:10,169 - INFO - ============================================================
2026-01-05 10:40:10,295 - INFO - Training samples: 8192
2026-01-05 10:40:10,295 - INFO - Validation samples: 2048
2026-01-05 10:40:10,295 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 10:40:10,295 - INFO - Building model architecture...
2026-01-05 10:40:11,584 - INFO - Model created with 188 layers
2026-01-05 10:40:11,584 - INFO - Trainable parameters: 25,305,860
2026-01-05 10:40:11,594 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 11:10:03,855 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 11:25:08,304 - INFO - 
Evaluating fold performance...
2026-01-05 11:25:15,095 - INFO - 
Fold 2 Results:
2026-01-05 11:25:15,096 - INFO -   • Accuracy:  0.7832
2026-01-05 11:25:15,099 - INFO -   • Precision: 0.7914
2026-01-05 11:25:15,099 - INFO -   • Recall:    0.7832
2026-01-05 11:25:15,100 - INFO -   • F1-Score:  0.7697
2026-01-05 11:25:15,101 - INFO -   • Kappa:     0.7109
2026-01-05 11:25:15,709 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-05 11:25:16,114 - INFO - 
============================================================
2026-01-05 11:25:16,114 - INFO - Training Fold 3/5
2026-01-05 11:25:16,117 - INFO - ============================================================
2026-01-05 11:25:16,272 - INFO - Training samples: 8192
2026-01-05 11:25:16,272 - INFO - Validation samples: 2048
2026-01-05 11:25:16,277 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 11:25:16,277 - INFO - Building model architecture...
2026-01-05 11:25:17,722 - INFO - Model created with 188 layers
2026-01-05 11:25:17,725 - INFO - Trainable parameters: 25,305,860
2026-01-05 11:25:17,735 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 11:56:27,008 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 12:12:04,351 - INFO - 
Evaluating fold performance...
2026-01-05 12:12:10,906 - INFO - 
Fold 3 Results:
2026-01-05 12:12:10,907 - INFO -   • Accuracy:  0.7651
2026-01-05 12:12:10,907 - INFO -   • Precision: 0.8331
2026-01-05 12:12:10,908 - INFO -   • Recall:    0.7651
2026-01-05 12:12:10,908 - INFO -   • F1-Score:  0.7285
2026-01-05 12:12:10,908 - INFO -   • Kappa:     0.6868
2026-01-05 12:12:11,517 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_3.keras
2026-01-05 12:12:11,877 - INFO - 
============================================================
2026-01-05 12:12:11,877 - INFO - Training Fold 4/5
2026-01-05 12:12:11,878 - INFO - ============================================================
2026-01-05 12:12:12,021 - INFO - Training samples: 8192
2026-01-05 12:12:12,021 - INFO - Validation samples: 2048
2026-01-05 12:12:12,024 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 12:12:12,024 - INFO - Building model architecture...
2026-01-05 12:12:13,402 - INFO - Model created with 188 layers
2026-01-05 12:12:13,410 - INFO - Trainable parameters: 25,305,860
2026-01-05 12:12:13,419 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 12:44:47,059 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 13:01:03,114 - INFO - 
Evaluating fold performance...
2026-01-05 13:01:09,675 - INFO - 
Fold 4 Results:
2026-01-05 13:01:09,675 - INFO -   • Accuracy:  0.8281
2026-01-05 13:01:09,678 - INFO -   • Precision: 0.8346
2026-01-05 13:01:09,679 - INFO -   • Recall:    0.8281
2026-01-05 13:01:09,680 - INFO -   • F1-Score:  0.8239
2026-01-05 13:01:09,681 - INFO -   • Kappa:     0.7708
2026-01-05 13:01:10,326 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_4.keras
2026-01-05 13:01:10,705 - INFO - 
============================================================
2026-01-05 13:01:10,706 - INFO - Training Fold 5/5
2026-01-05 13:01:10,708 - INFO - ============================================================
2026-01-05 13:01:10,859 - INFO - Training samples: 8192
2026-01-05 13:01:10,859 - INFO - Validation samples: 2048
2026-01-05 13:01:10,862 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 13:01:10,863 - INFO - Building model architecture...
2026-01-05 13:01:12,159 - INFO - Model created with 188 layers
2026-01-05 13:01:12,162 - INFO - Trainable parameters: 25,305,860
2026-01-05 13:01:12,170 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 13:33:30,225 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 13:49:31,765 - INFO - 
Evaluating fold performance...
2026-01-05 13:49:38,207 - INFO - 
Fold 5 Results:
2026-01-05 13:49:38,207 - INFO -   • Accuracy:  0.7690
2026-01-05 13:49:38,208 - INFO -   • Precision: 0.8161
2026-01-05 13:49:38,208 - INFO -   • Recall:    0.7690
2026-01-05 13:49:38,208 - INFO -   • F1-Score:  0.7415
2026-01-05 13:49:38,209 - INFO -   • Kappa:     0.6921
2026-01-05 13:49:38,772 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_5.keras
2026-01-05 13:49:39,133 - INFO - 
============================================================
2026-01-05 13:49:39,134 - INFO - K-Fold Cross-Validation Summary
2026-01-05 13:49:39,134 - INFO - ============================================================
2026-01-05 13:49:39,134 - INFO - Average Accuracy:  0.7938 ± 0.0269
2026-01-05 13:49:39,135 - INFO - Average Precision: 0.8245
2026-01-05 13:49:39,136 - INFO - Average Recall:    0.7938
2026-01-05 13:49:39,137 - INFO - Average F1-Score:  0.7753 ± 0.0379
2026-01-05 13:49:39,138 - INFO - Average Kappa:     0.7251
2026-01-05 13:49:39,142 - INFO - Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-05 13:49:39,142 - INFO - Generating K-Fold visualization plots...
2026-01-05 13:49:40,530 - INFO - K-fold analysis plot saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-05 13:49:40,539 - INFO - 
================================================================================
2026-01-05 13:49:40,539 - INFO - Evaluating on Test Set
2026-01-05 13:49:40,540 - INFO - ================================================================================

2026-01-05 13:49:40,684 - INFO - 
============================================================
2026-01-05 13:49:40,685 - INFO - Making Ensemble Predictions
2026-01-05 13:49:40,686 - INFO - ============================================================
2026-01-05 13:49:40,687 - INFO - Combining predictions from 5 models...
2026-01-05 13:49:40,688 - INFO - Loading model 1/5: model_fold_1.keras
2026-01-05 13:49:49,419 - INFO - Loading model 2/5: model_fold_2.keras
2026-01-05 13:49:55,822 - INFO - Loading model 3/5: model_fold_3.keras
2026-01-05 13:50:02,201 - INFO - Loading model 4/5: model_fold_4.keras
2026-01-05 13:50:08,638 - INFO - Loading model 5/5: model_fold_5.keras
2026-01-05 13:50:15,040 - INFO - Ensemble prediction shape: (1183, 4)
2026-01-05 13:50:15,047 - INFO - 
============================================================
2026-01-05 13:50:15,047 - INFO - ENSEMBLE TEST RESULTS
2026-01-05 13:50:15,048 - INFO - ============================================================
2026-01-05 13:50:15,049 - INFO - Accuracy:          0.6560 (65.60%)
2026-01-05 13:50:15,050 - INFO - Precision (Macro): 0.7299
2026-01-05 13:50:15,050 - INFO - Recall (Macro):    0.6873
2026-01-05 13:50:15,051 - INFO - F1-Score (Macro):  0.6167
2026-01-05 13:50:15,052 - INFO - Cohen's Kappa:     0.4018
2026-01-05 13:50:15,053 - INFO - MCC:               0.4462
2026-01-05 13:50:15,062 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.32      0.93      0.48        83
 Moderate Impairment       1.00      0.67      0.80        12
       No Impairment       0.72      0.90      0.80       640
Very Mild Impairment       0.88      0.25      0.39       448

            accuracy                           0.66      1183
           macro avg       0.73      0.69      0.62      1183
        weighted avg       0.75      0.66      0.62      1183

2026-01-05 13:50:15,064 - INFO - Metrics saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-05 13:50:15,800 - INFO - Confusion matrix saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2026-01-05 13:50:15,801 - INFO - 
================================================================================
2026-01-05 13:50:15,804 - INFO - Generating Grad-CAM++ Visualizations
2026-01-05 13:50:15,805 - INFO - ================================================================================

2026-01-05 13:50:17,771 - INFO - Processing 3 images for class: Mild Impairment
2026-01-05 13:50:22,133 - INFO - Processing 3 images for class: Moderate Impairment
2026-01-05 13:50:24,914 - INFO - Processing 3 images for class: No Impairment
2026-01-05 13:50:27,670 - INFO - Processing 3 images for class: Very Mild Impairment
2026-01-05 13:50:30,674 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus
2026-01-05 13:50:30,841 - INFO - 
================================================================================
2026-01-05 13:50:30,841 - INFO - Starting SHAP Analysis
2026-01-05 13:50:30,843 - INFO - ================================================================================

2026-01-05 13:50:30,844 - WARNING - SHAP not available or failed to import. Skipping analysis.
2026-01-05 13:50:30,845 - INFO - 
================================================================================
2026-01-05 13:50:30,846 - INFO - ANALYSIS COMPLETE!
2026-01-05 13:50:30,847 - INFO - ================================================================================

2026-01-05 13:50:30,847 - INFO - All results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced

2026-01-05 13:50:30,848 - INFO - Generated Files:
2026-01-05 13:50:30,849 - INFO -   K-Fold Analysis:  C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-05 13:50:30,850 - INFO -   K-Fold Results:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-05 13:50:30,850 - INFO -   Ensemble Results: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-05 13:50:30,851 - INFO -   Grad-CAM++ Viz:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus/
2026-01-05 13:50:30,852 - INFO -   SHAP Analysis:    C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis/
2026-01-05 13:50:30,853 - INFO -   Trained Models:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models/
2026-01-05 13:50:30,853 - INFO - 
================================================================================

2026-01-05 13:56:24,360 - INFO - ================================================================================
2026-01-05 13:56:24,360 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-05 13:56:24,361 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-05 13:56:24,361 - INFO - ================================================================================
2026-01-05 13:56:24,361 - INFO - Configuration:
2026-01-05 13:56:24,361 - INFO -   • Image Size: 224x224
2026-01-05 13:56:24,361 - INFO -   • Batch Size: 16
2026-01-05 13:56:24,361 - INFO -   • K-Folds: 5
2026-01-05 13:56:24,361 - INFO -   • Epochs: 100
2026-01-05 13:56:24,468 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-05 13:56:24,468 - INFO - Starting K-Fold Cross-Validation...
2026-01-05 13:56:24,469 - INFO - 
================================================================================
2026-01-05 13:56:24,469 - INFO - Starting 5-Fold Cross-Validation
2026-01-05 13:56:24,470 - INFO - ================================================================================

2026-01-05 13:56:24,471 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-05 13:56:24,523 - INFO - Found 10240 images from 4 classes
2026-01-05 13:56:24,523 - INFO -   • Mild Impairment: 2560 images
2026-01-05 13:56:24,526 - INFO -   • Moderate Impairment: 2560 images
2026-01-05 13:56:24,526 - INFO -   • No Impairment: 2560 images
2026-01-05 13:56:24,527 - INFO -   • Very Mild Impairment: 2560 images
2026-01-05 13:56:24,533 - INFO - 
============================================================
2026-01-05 13:56:24,533 - INFO - Training Fold 1/5
2026-01-05 13:56:24,534 - INFO - ============================================================
2026-01-05 13:56:24,660 - INFO - Training samples: 8192
2026-01-05 13:56:24,661 - INFO - Validation samples: 2048
2026-01-05 13:56:24,667 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 13:56:24,667 - INFO - Building model architecture...
2026-01-05 13:56:27,362 - INFO - Model created with 188 layers
2026-01-05 13:56:27,365 - INFO - Trainable parameters: 25,305,860
2026-01-05 13:56:27,373 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 13:57:52,680 - INFO - ================================================================================
2026-01-05 13:57:52,680 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-05 13:57:52,681 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-05 13:57:52,681 - INFO - ================================================================================
2026-01-05 13:57:52,682 - INFO - Configuration:
2026-01-05 13:57:52,682 - INFO -   • Image Size: 224x224
2026-01-05 13:57:52,682 - INFO -   • Batch Size: 16
2026-01-05 13:57:52,683 - INFO -   • K-Folds: 5
2026-01-05 13:57:52,683 - INFO -   • Epochs: 100
2026-01-05 13:57:52,772 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-05 13:57:52,773 - INFO - Starting K-Fold Cross-Validation...
2026-01-05 13:57:52,775 - INFO - 
================================================================================
2026-01-05 13:57:52,776 - INFO - Starting 5-Fold Cross-Validation
2026-01-05 13:57:52,777 - INFO - ================================================================================

2026-01-05 13:57:52,777 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-05 13:57:52,823 - INFO - Found 10240 images from 4 classes
2026-01-05 13:57:52,823 - INFO -   • Mild Impairment: 2560 images
2026-01-05 13:57:52,826 - INFO -   • Moderate Impairment: 2560 images
2026-01-05 13:57:52,827 - INFO -   • No Impairment: 2560 images
2026-01-05 13:57:52,828 - INFO -   • Very Mild Impairment: 2560 images
2026-01-05 13:57:52,831 - INFO - 
============================================================
2026-01-05 13:57:52,831 - INFO - Training Fold 1/5
2026-01-05 13:57:52,832 - INFO - ============================================================
2026-01-05 13:57:52,948 - INFO - Training samples: 8192
2026-01-05 13:57:52,948 - INFO - Validation samples: 2048
2026-01-05 13:57:52,952 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 13:57:52,953 - INFO - Building model architecture...
2026-01-05 13:57:55,657 - INFO - Model created with 188 layers
2026-01-05 13:57:55,660 - INFO - Trainable parameters: 25,305,860
2026-01-05 13:57:55,668 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 14:19:05,009 - INFO - ================================================================================
2026-01-05 14:19:05,009 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-05 14:19:05,010 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-05 14:19:05,010 - INFO - ================================================================================
2026-01-05 14:19:05,010 - INFO - Configuration:
2026-01-05 14:19:05,010 - INFO -   • Image Size: 224x224
2026-01-05 14:19:05,010 - INFO -   • Batch Size: 16
2026-01-05 14:19:05,010 - INFO -   • K-Folds: 5
2026-01-05 14:19:05,010 - INFO -   • Epochs: 60
2026-01-05 14:19:05,092 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-05 14:19:05,093 - INFO - Deterministic operations enabled
2026-01-05 14:19:05,093 - INFO - Starting K-Fold Cross-Validation...
2026-01-05 14:19:05,094 - INFO - 
================================================================================
2026-01-05 14:19:05,095 - INFO - Starting 5-Fold Cross-Validation
2026-01-05 14:19:05,096 - INFO - ================================================================================

2026-01-05 14:19:05,096 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-05 14:19:05,150 - INFO - Found 10240 images from 4 classes
2026-01-05 14:19:05,150 - INFO -   • Mild Impairment: 2560 images
2026-01-05 14:19:05,153 - INFO -   • Moderate Impairment: 2560 images
2026-01-05 14:19:05,153 - INFO -   • No Impairment: 2560 images
2026-01-05 14:19:05,154 - INFO -   • Very Mild Impairment: 2560 images
2026-01-05 14:19:05,159 - INFO - 
============================================================
2026-01-05 14:19:05,159 - INFO - Training Fold 1/5
2026-01-05 14:19:05,160 - INFO - ============================================================
2026-01-05 14:19:05,277 - INFO - Training samples: 8192
2026-01-05 14:19:05,277 - INFO - Validation samples: 2048
2026-01-05 14:19:05,281 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 14:19:05,281 - INFO - Building model architecture...
2026-01-05 14:19:07,921 - INFO - Model created with 188 layers
2026-01-05 14:19:07,924 - INFO - Trainable parameters: 25,305,860
2026-01-05 14:19:07,933 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 14:22:23,518 - INFO - ================================================================================
2026-01-05 14:22:23,518 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-05 14:22:23,521 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-05 14:22:23,522 - INFO - ================================================================================
2026-01-05 14:22:23,523 - INFO - Configuration:
2026-01-05 14:22:23,524 - INFO -   • Image Size: 224x224
2026-01-05 14:22:23,525 - INFO -   • Batch Size: 32
2026-01-05 14:22:23,526 - INFO -   • K-Folds: 5
2026-01-05 14:22:23,527 - INFO -   • Epochs: 60
2026-01-05 14:22:23,594 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-05 14:22:23,594 - INFO - Deterministic operations enabled
2026-01-05 14:22:23,596 - INFO - Starting K-Fold Cross-Validation...
2026-01-05 14:22:23,596 - INFO - 
================================================================================
2026-01-05 14:22:23,598 - INFO - Starting 5-Fold Cross-Validation
2026-01-05 14:22:23,599 - INFO - ================================================================================

2026-01-05 14:22:23,600 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-05 14:22:23,657 - INFO - Found 10240 images from 4 classes
2026-01-05 14:22:23,657 - INFO -   • Mild Impairment: 2560 images
2026-01-05 14:22:23,659 - INFO -   • Moderate Impairment: 2560 images
2026-01-05 14:22:23,660 - INFO -   • No Impairment: 2560 images
2026-01-05 14:22:23,661 - INFO -   • Very Mild Impairment: 2560 images
2026-01-05 14:22:23,665 - INFO - 
============================================================
2026-01-05 14:22:23,665 - INFO - Training Fold 1/5
2026-01-05 14:22:23,666 - INFO - ============================================================
2026-01-05 14:22:23,782 - INFO - Training samples: 8192
2026-01-05 14:22:23,782 - INFO - Validation samples: 2048
2026-01-05 14:22:23,786 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 14:22:23,787 - INFO - Building model architecture...
2026-01-05 14:22:26,421 - INFO - Model created with 188 layers
2026-01-05 14:22:26,424 - INFO - Trainable parameters: 25,305,860
2026-01-05 14:22:26,432 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 15:01:19,954 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 15:41:29,455 - INFO - 
Evaluating fold performance...
2026-01-05 15:41:38,346 - INFO - 
Fold 1 Results:
2026-01-05 15:41:38,347 - INFO -   • Accuracy:  0.9302
2026-01-05 15:41:38,350 - INFO -   • Precision: 0.9349
2026-01-05 15:41:38,350 - INFO -   • Recall:    0.9302
2026-01-05 15:41:38,351 - INFO -   • F1-Score:  0.9287
2026-01-05 15:41:38,352 - INFO -   • Kappa:     0.9069
2026-01-05 15:41:38,979 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-05 15:41:39,207 - INFO - 
============================================================
2026-01-05 15:41:39,208 - INFO - Training Fold 2/5
2026-01-05 15:41:39,210 - INFO - ============================================================
2026-01-05 15:41:39,370 - INFO - Training samples: 8192
2026-01-05 15:41:39,370 - INFO - Validation samples: 2048
2026-01-05 15:41:39,374 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 15:41:39,374 - INFO - Building model architecture...
2026-01-05 15:41:40,695 - INFO - Model created with 188 layers
2026-01-05 15:41:40,698 - INFO - Trainable parameters: 25,305,860
2026-01-05 15:41:40,706 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 16:20:53,565 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 17:01:07,972 - INFO - 
Evaluating fold performance...
2026-01-05 17:01:17,567 - INFO - 
Fold 2 Results:
2026-01-05 17:01:17,568 - INFO -   • Accuracy:  0.9351
2026-01-05 17:01:17,568 - INFO -   • Precision: 0.9368
2026-01-05 17:01:17,569 - INFO -   • Recall:    0.9351
2026-01-05 17:01:17,569 - INFO -   • F1-Score:  0.9346
2026-01-05 17:01:17,569 - INFO -   • Kappa:     0.9134
2026-01-05 17:01:18,176 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-05 17:01:18,591 - INFO - 
============================================================
2026-01-05 17:01:18,591 - INFO - Training Fold 3/5
2026-01-05 17:01:18,592 - INFO - ============================================================
2026-01-05 17:01:18,765 - INFO - Training samples: 8192
2026-01-05 17:01:18,765 - INFO - Validation samples: 2048
2026-01-05 17:01:18,767 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 17:01:18,768 - INFO - Building model architecture...
2026-01-05 17:01:20,478 - INFO - Model created with 188 layers
2026-01-05 17:01:20,481 - INFO - Trainable parameters: 25,305,860
2026-01-05 17:01:20,491 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 17:39:53,664 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 18:20:43,393 - INFO - 
Evaluating fold performance...
2026-01-05 18:20:52,540 - INFO - 
Fold 3 Results:
2026-01-05 18:20:52,540 - INFO -   • Accuracy:  0.9453
2026-01-05 18:20:52,542 - INFO -   • Precision: 0.9455
2026-01-05 18:20:52,543 - INFO -   • Recall:    0.9453
2026-01-05 18:20:52,544 - INFO -   • F1-Score:  0.9450
2026-01-05 18:20:52,545 - INFO -   • Kappa:     0.9271
2026-01-05 18:20:53,155 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_3.keras
2026-01-05 18:20:53,560 - INFO - 
============================================================
2026-01-05 18:20:53,560 - INFO - Training Fold 4/5
2026-01-05 18:20:53,563 - INFO - ============================================================
2026-01-05 18:20:53,735 - INFO - Training samples: 8192
2026-01-05 18:20:53,735 - INFO - Validation samples: 2048
2026-01-05 18:20:53,740 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 18:20:53,740 - INFO - Building model architecture...
2026-01-05 18:20:55,080 - INFO - Model created with 188 layers
2026-01-05 18:20:55,083 - INFO - Trainable parameters: 25,305,860
2026-01-05 18:20:55,092 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 19:00:42,386 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 19:42:29,407 - INFO - 
Evaluating fold performance...
2026-01-05 19:42:38,904 - INFO - 
Fold 4 Results:
2026-01-05 19:42:38,905 - INFO -   • Accuracy:  0.9180
2026-01-05 19:42:38,907 - INFO -   • Precision: 0.9271
2026-01-05 19:42:38,908 - INFO -   • Recall:    0.9180
2026-01-05 19:42:38,909 - INFO -   • F1-Score:  0.9158
2026-01-05 19:42:38,910 - INFO -   • Kappa:     0.8906
2026-01-05 19:42:39,587 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_4.keras
2026-01-05 19:42:39,986 - INFO - 
============================================================
2026-01-05 19:42:39,986 - INFO - Training Fold 5/5
2026-01-05 19:42:39,988 - INFO - ============================================================
2026-01-05 19:42:40,161 - INFO - Training samples: 8192
2026-01-05 19:42:40,161 - INFO - Validation samples: 2048
2026-01-05 19:42:40,164 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-05 19:42:40,165 - INFO - Building model architecture...
2026-01-05 19:42:41,509 - INFO - Model created with 188 layers
2026-01-05 19:42:41,512 - INFO - Trainable parameters: 25,305,860
2026-01-05 19:42:41,521 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-05 20:23:45,887 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-05 21:05:58,730 - INFO - 
Evaluating fold performance...
2026-01-05 21:06:07,504 - INFO - 
Fold 5 Results:
2026-01-05 21:06:07,504 - INFO -   • Accuracy:  0.8535
2026-01-05 21:06:07,506 - INFO -   • Precision: 0.8694
2026-01-05 21:06:07,507 - INFO -   • Recall:    0.8535
2026-01-05 21:06:07,508 - INFO -   • F1-Score:  0.8514
2026-01-05 21:06:07,509 - INFO -   • Kappa:     0.8047
2026-01-05 21:06:08,191 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_5.keras
2026-01-05 21:06:08,596 - INFO - 
============================================================
2026-01-05 21:06:08,597 - INFO - K-Fold Cross-Validation Summary
2026-01-05 21:06:08,599 - INFO - ============================================================
2026-01-05 21:06:08,600 - INFO - Average Accuracy:  0.9164 ± 0.0327
2026-01-05 21:06:08,601 - INFO - Average Precision: 0.9227
2026-01-05 21:06:08,602 - INFO - Average Recall:    0.9164
2026-01-05 21:06:08,603 - INFO - Average F1-Score:  0.9151 ± 0.0332
2026-01-05 21:06:08,604 - INFO - Average Kappa:     0.8885
2026-01-05 21:06:08,607 - INFO - Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-05 21:06:08,607 - INFO - Generating K-Fold visualization plots...
2026-01-05 21:06:09,996 - INFO - K-fold analysis plot saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-05 21:06:10,005 - INFO - 
================================================================================
2026-01-05 21:06:10,006 - INFO - Evaluating on Test Set
2026-01-05 21:06:10,006 - INFO - ================================================================================

2026-01-05 21:06:10,163 - INFO - 
============================================================
2026-01-05 21:06:10,163 - INFO - Making Ensemble Predictions
2026-01-05 21:06:10,164 - INFO - ============================================================
2026-01-05 21:06:10,165 - INFO - Combining predictions from 5 models...
2026-01-05 21:06:10,167 - INFO - Loading model 1/5: model_fold_1.keras
2026-01-05 21:06:19,731 - INFO -   Predictions shape: (1183, 4)
2026-01-05 21:06:20,147 - INFO - Loading model 2/5: model_fold_2.keras
2026-01-05 21:06:28,450 - INFO -   Predictions shape: (1183, 4)
2026-01-05 21:06:28,609 - INFO - Loading model 3/5: model_fold_3.keras
2026-01-05 21:06:36,828 - INFO -   Predictions shape: (1183, 4)
2026-01-05 21:06:36,990 - INFO - Loading model 4/5: model_fold_4.keras
2026-01-05 21:06:45,246 - INFO -   Predictions shape: (1183, 4)
2026-01-05 21:06:45,412 - INFO - Loading model 5/5: model_fold_5.keras
2026-01-05 21:06:53,721 - INFO -   Predictions shape: (1183, 4)
2026-01-05 21:06:53,881 - INFO - Ensemble prediction shape: (1183, 4)
2026-01-05 21:06:53,888 - INFO - 
============================================================
2026-01-05 21:06:53,888 - INFO - ENSEMBLE TEST RESULTS
2026-01-05 21:06:53,890 - INFO - ============================================================
2026-01-05 21:06:53,890 - INFO - Accuracy:          0.9079 (90.79%)
2026-01-05 21:06:53,891 - INFO - Precision (Macro): 0.9138
2026-01-05 21:06:53,892 - INFO - Recall (Macro):    0.9368
2026-01-05 21:06:53,893 - INFO - F1-Score (Macro):  0.9197
2026-01-05 21:06:53,893 - INFO - Cohen's Kappa:     0.8340
2026-01-05 21:06:53,894 - INFO - MCC:               0.8407
2026-01-05 21:06:53,904 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.79      0.98      0.87        83
 Moderate Impairment       1.00      1.00      1.00        12
       No Impairment       0.89      0.98      0.93       640
Very Mild Impairment       0.98      0.79      0.88       448

            accuracy                           0.91      1183
           macro avg       0.91      0.94      0.92      1183
        weighted avg       0.92      0.91      0.91      1183

2026-01-05 21:06:53,906 - INFO - Metrics saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-05 21:06:54,692 - INFO - Confusion matrix saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2026-01-05 21:06:54,692 - INFO - 
================================================================================
2026-01-05 21:06:54,695 - INFO - Generating Grad-CAM++ Visualizations
2026-01-05 21:06:54,696 - INFO - ================================================================================

2026-01-05 21:06:56,878 - INFO - Processing 3 images for class: Mild Impairment
2026-01-05 21:06:58,366 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\Mild Impairment\24 (25).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:06:58,597 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\Mild Impairment\24 (3).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:06:58,827 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\Mild Impairment\24 (8).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:06:58,830 - INFO - Processing 3 images for class: Moderate Impairment
2026-01-05 21:06:59,060 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\Moderate Impairment\12.jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:06:59,292 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\Moderate Impairment\13 (2).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:06:59,523 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\Moderate Impairment\14.jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:06:59,527 - INFO - Processing 3 images for class: No Impairment
2026-01-05 21:06:59,743 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\No Impairment\1 (16).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:06:59,976 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\No Impairment\1 (21).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:07:00,213 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\No Impairment\1 (28).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:07:00,216 - INFO - Processing 3 images for class: Very Mild Impairment
2026-01-05 21:07:00,458 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\Very Mild Impairment\1 (10).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:07:00,695 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\Very Mild Impairment\1 (13).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:07:00,918 - WARNING - Error processing C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test\Very Mild Impairment\1 (17).jpg: {{function_node __wrapped__FusedBatchNormGradV3_device_/job:localhost/replica:0/task:0/device:GPU:0}} A deterministic GPU implementation of fused batch-norm backprop, when training is disabled, is not currently available. [Op:FusedBatchNormGradV3]
2026-01-05 21:07:00,921 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus
2026-01-05 21:07:01,090 - INFO - 
================================================================================
2026-01-05 21:07:01,091 - INFO - Starting SHAP Analysis
2026-01-05 21:07:01,093 - INFO - ================================================================================

2026-01-05 21:07:01,094 - INFO - 
============================================================
2026-01-05 21:07:01,095 - INFO - Starting SHAP Analysis
2026-01-05 21:07:01,096 - INFO - ============================================================
2026-01-05 21:07:01,097 - INFO - Loading model from: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-05 21:07:03,426 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test
2026-01-05 21:07:03,435 - INFO - Found 1183 images from 4 classes
2026-01-05 21:07:03,436 - INFO -   • Mild Impairment: 83 images
2026-01-05 21:07:03,437 - INFO -   • Moderate Impairment: 12 images
2026-01-05 21:07:03,437 - INFO -   • No Impairment: 640 images
2026-01-05 21:07:03,440 - INFO -   • Very Mild Impairment: 448 images
2026-01-05 21:07:03,441 - INFO - Loading 50 background samples...
2026-01-05 21:07:03,509 - INFO - Loaded 50 background samples
2026-01-05 21:07:03,509 - INFO - Loading 10 test samples...
2026-01-05 21:07:03,523 - INFO - Loaded 10 test samples
2026-01-05 21:07:03,524 - INFO - Creating SHAP DeepExplainer (this may take a few minutes)...
2026-01-05 21:07:04,255 - INFO - Calculating SHAP values...
2026-01-05 21:07:05,469 - ERROR - Error during SHAP analysis: in user code:

    File "C:\Users\Lab1\miniconda3\envs\dis_gpu\lib\site-packages\shap\explainers\_deep\deep_tf.py", line 250, in grad_graph  *
        x_grad = tape.gradient(out, shap_rAnD)
    File "C:\Users\Lab1\miniconda3\envs\dis_gpu\lib\site-packages\shap\explainers\_deep\deep_tf.py", line 394, in custom_grad
        out = op_handlers[type_name](self, op, *grads)  # we cut off the shap_ prefix before the lookup
    File "C:\Users\Lab1\miniconda3\envs\dis_gpu\lib\site-packages\shap\explainers\_deep\deep_tf.py", line 674, in handler
        return linearity_1d_handler(input_ind, explainer, op, *grads)
    File "C:\Users\Lab1\miniconda3\envs\dis_gpu\lib\site-packages\shap\explainers\_deep\deep_tf.py", line 686, in linearity_1d_handler
        return explainer.orig_grads[op.type](op, *grads)

    ValueError: Cannot reshape a tensor with 1433600 elements to shape [100,2048] (204800 elements) for '{{node gradient_tape/model/dense_1/Tensordot/Reshape}} = Reshape[T=DT_FLOAT, Tshape=DT_INT32](gradient_tape/model/dense_1/Sigmoid/SelectV2, gradient_tape/model/dense_1/Tensordot/Shape)' with input shapes: [100,1,7,2048], [2] and with input tensors computed as partial shapes: input[1] = [100,2048].

2026-01-05 21:07:05,616 - INFO - 
================================================================================
2026-01-05 21:07:05,616 - INFO - ANALYSIS COMPLETE!
2026-01-05 21:07:05,619 - INFO - ================================================================================

2026-01-05 21:07:05,619 - INFO - All results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced

2026-01-05 21:07:05,620 - INFO - Generated Files:
2026-01-05 21:07:05,621 - INFO -   K-Fold Analysis:  C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-05 21:07:05,622 - INFO -   K-Fold Results:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-05 21:07:05,623 - INFO -   Ensemble Results: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-05 21:07:05,623 - INFO -   Grad-CAM++ Viz:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus/
2026-01-05 21:07:05,625 - INFO -   SHAP Analysis:    C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis/
2026-01-05 21:07:05,626 - INFO -   Trained Models:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models/
2026-01-05 21:07:05,627 - INFO - 
================================================================================

2026-01-06 09:31:49,649 - INFO - ================================================================================
2026-01-06 09:31:49,650 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-06 09:31:49,650 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-06 09:31:49,651 - INFO - ================================================================================
2026-01-06 09:31:49,651 - INFO - Configuration:
2026-01-06 09:31:49,651 - INFO -   • Image Size: 224x224
2026-01-06 09:31:49,651 - INFO -   • Batch Size: 32
2026-01-06 09:31:49,651 - INFO -   • K-Folds: 5
2026-01-06 09:31:49,651 - INFO -   • Epochs: 2
2026-01-06 09:31:49,798 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-06 09:31:49,799 - INFO - Random seeds set (Strict determinism disabled for GPU compatibility)
2026-01-06 09:31:49,800 - INFO - Starting K-Fold Cross-Validation...
2026-01-06 09:31:49,800 - INFO - 
================================================================================
2026-01-06 09:31:49,801 - INFO - Starting 5-Fold Cross-Validation
2026-01-06 09:31:49,801 - INFO - ================================================================================

2026-01-06 09:31:49,801 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-06 09:31:49,847 - INFO - Found 10240 images from 4 classes
2026-01-06 09:31:49,847 - INFO -   • Mild Impairment: 2560 images
2026-01-06 09:31:49,848 - INFO -   • Moderate Impairment: 2560 images
2026-01-06 09:31:49,848 - INFO -   • No Impairment: 2560 images
2026-01-06 09:31:49,848 - INFO -   • Very Mild Impairment: 2560 images
2026-01-06 09:31:49,853 - INFO - 
============================================================
2026-01-06 09:31:49,853 - INFO - Training Fold 1/5
2026-01-06 09:31:49,854 - INFO - ============================================================
2026-01-06 09:31:49,980 - INFO - Training samples: 8192
2026-01-06 09:31:49,980 - INFO - Validation samples: 2048
2026-01-06 09:31:49,984 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 09:31:49,985 - INFO - Building model architecture...
2026-01-06 09:31:52,791 - INFO - Model created with 188 layers
2026-01-06 09:31:52,793 - INFO - Trainable parameters: 25,305,860
2026-01-06 09:31:52,802 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 09:33:52,416 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 09:33:52,860 - INFO - 
Evaluating fold performance...
2026-01-06 09:33:58,824 - INFO - 
Fold 1 Results:
2026-01-06 09:33:58,825 - INFO -   • Accuracy:  0.5605
2026-01-06 09:33:58,826 - INFO -   • Precision: 0.6519
2026-01-06 09:33:58,826 - INFO -   • Recall:    0.5605
2026-01-06 09:33:58,827 - INFO -   • F1-Score:  0.5532
2026-01-06 09:33:58,828 - INFO -   • Kappa:     0.4141
2026-01-06 09:33:59,304 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 09:33:59,305 - ERROR - Error during execution: 'loss'
Traceback (most recent call last):
  File "C:\Users\Lab1\Desktop\Alzhimer\main.py", line 325, in main
    fold_model_paths, fold_results = train_kfold_models()
  File "C:\Users\Lab1\Desktop\Alzhimer\main.py", line 196, in train_kfold_models
    'loss': history1.history['loss'] + history2.history['loss'],
KeyError: 'loss'
2026-01-06 09:35:11,853 - INFO - ================================================================================
2026-01-06 09:35:11,854 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-06 09:35:11,855 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-06 09:35:11,856 - INFO - ================================================================================
2026-01-06 09:35:11,860 - INFO - Configuration:
2026-01-06 09:35:11,861 - INFO -   • Image Size: 224x224
2026-01-06 09:35:11,861 - INFO -   • Batch Size: 32
2026-01-06 09:35:11,862 - INFO -   • K-Folds: 5
2026-01-06 09:35:11,862 - INFO -   • Epochs: 2
2026-01-06 09:35:11,995 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-06 09:35:11,995 - INFO - Random seeds set (Strict determinism disabled for GPU compatibility)
2026-01-06 09:35:11,998 - INFO - Starting K-Fold Cross-Validation...
2026-01-06 09:35:11,998 - INFO - 
================================================================================
2026-01-06 09:35:12,000 - INFO - Starting 5-Fold Cross-Validation
2026-01-06 09:35:12,000 - INFO - ================================================================================

2026-01-06 09:35:12,001 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-06 09:35:12,047 - INFO - Found 10240 images from 4 classes
2026-01-06 09:35:12,048 - INFO -   • Mild Impairment: 2560 images
2026-01-06 09:35:12,050 - INFO -   • Moderate Impairment: 2560 images
2026-01-06 09:35:12,051 - INFO -   • No Impairment: 2560 images
2026-01-06 09:35:12,052 - INFO -   • Very Mild Impairment: 2560 images
2026-01-06 09:35:12,057 - INFO - 
============================================================
2026-01-06 09:35:12,057 - INFO - Training Fold 1/5
2026-01-06 09:35:12,058 - INFO - ============================================================
2026-01-06 09:35:12,185 - INFO - Training samples: 8192
2026-01-06 09:35:12,185 - INFO - Validation samples: 2048
2026-01-06 09:35:12,189 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 09:35:12,189 - INFO - Building model architecture...
2026-01-06 09:35:14,950 - INFO - Model created with 188 layers
2026-01-06 09:35:14,953 - INFO - Trainable parameters: 25,305,860
2026-01-06 09:35:14,963 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 09:36:46,917 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 09:38:18,440 - INFO - 
Evaluating fold performance...
2026-01-06 09:38:24,000 - INFO - 
Fold 1 Results:
2026-01-06 09:38:24,000 - INFO -   • Accuracy:  0.7227
2026-01-06 09:38:24,002 - INFO -   • Precision: 0.7399
2026-01-06 09:38:24,002 - INFO -   • Recall:    0.7227
2026-01-06 09:38:24,002 - INFO -   • F1-Score:  0.6884
2026-01-06 09:38:24,003 - INFO -   • Kappa:     0.6302
2026-01-06 09:38:24,631 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 09:38:24,862 - INFO - 
============================================================
2026-01-06 09:38:24,862 - INFO - Training Fold 2/5
2026-01-06 09:38:24,864 - INFO - ============================================================
2026-01-06 09:38:25,035 - INFO - Training samples: 8192
2026-01-06 09:38:25,035 - INFO - Validation samples: 2048
2026-01-06 09:38:25,039 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 09:38:25,040 - INFO - Building model architecture...
2026-01-06 09:38:26,393 - INFO - Model created with 188 layers
2026-01-06 09:38:26,396 - INFO - Trainable parameters: 25,305,860
2026-01-06 09:38:26,404 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 09:39:58,509 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 09:41:32,263 - INFO - 
Evaluating fold performance...
2026-01-06 09:41:37,836 - INFO - 
Fold 2 Results:
2026-01-06 09:41:37,837 - INFO -   • Accuracy:  0.7397
2026-01-06 09:41:37,839 - INFO -   • Precision: 0.7730
2026-01-06 09:41:37,841 - INFO -   • Recall:    0.7397
2026-01-06 09:41:37,842 - INFO -   • F1-Score:  0.7128
2026-01-06 09:41:37,842 - INFO -   • Kappa:     0.6530
2026-01-06 09:41:38,559 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-06 09:41:38,989 - INFO - 
============================================================
2026-01-06 09:41:38,989 - INFO - Training Fold 3/5
2026-01-06 09:41:38,991 - INFO - ============================================================
2026-01-06 09:41:39,167 - INFO - Training samples: 8192
2026-01-06 09:41:39,167 - INFO - Validation samples: 2048
2026-01-06 09:41:39,171 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 09:41:39,172 - INFO - Building model architecture...
2026-01-06 09:41:40,591 - INFO - Model created with 188 layers
2026-01-06 09:41:40,593 - INFO - Trainable parameters: 25,305,860
2026-01-06 09:41:40,603 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 09:43:14,065 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 09:44:48,750 - INFO - 
Evaluating fold performance...
2026-01-06 09:44:54,156 - INFO - 
Fold 3 Results:
2026-01-06 09:44:54,156 - INFO -   • Accuracy:  0.7188
2026-01-06 09:44:54,159 - INFO -   • Precision: 0.7488
2026-01-06 09:44:54,160 - INFO -   • Recall:    0.7188
2026-01-06 09:44:54,160 - INFO -   • F1-Score:  0.6669
2026-01-06 09:44:54,161 - INFO -   • Kappa:     0.6250
2026-01-06 09:44:54,843 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_3.keras
2026-01-06 09:44:55,257 - INFO - 
============================================================
2026-01-06 09:44:55,257 - INFO - Training Fold 4/5
2026-01-06 09:44:55,260 - INFO - ============================================================
2026-01-06 09:44:55,433 - INFO - Training samples: 8192
2026-01-06 09:44:55,434 - INFO - Validation samples: 2048
2026-01-06 09:44:55,438 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 09:44:55,438 - INFO - Building model architecture...
2026-01-06 09:44:56,819 - INFO - Model created with 188 layers
2026-01-06 09:44:56,822 - INFO - Trainable parameters: 25,305,860
2026-01-06 09:44:56,832 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 09:46:30,539 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 09:48:06,622 - INFO - 
Evaluating fold performance...
2026-01-06 09:48:12,046 - INFO - 
Fold 4 Results:
2026-01-06 09:48:12,047 - INFO -   • Accuracy:  0.7295
2026-01-06 09:48:12,049 - INFO -   • Precision: 0.7776
2026-01-06 09:48:12,050 - INFO -   • Recall:    0.7295
2026-01-06 09:48:12,051 - INFO -   • F1-Score:  0.6928
2026-01-06 09:48:12,052 - INFO -   • Kappa:     0.6393
2026-01-06 09:48:12,725 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_4.keras
2026-01-06 09:48:13,144 - INFO - 
============================================================
2026-01-06 09:48:13,144 - INFO - Training Fold 5/5
2026-01-06 09:48:13,147 - INFO - ============================================================
2026-01-06 09:48:13,327 - INFO - Training samples: 8192
2026-01-06 09:48:13,327 - INFO - Validation samples: 2048
2026-01-06 09:48:13,333 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 09:48:13,333 - INFO - Building model architecture...
2026-01-06 09:48:14,721 - INFO - Model created with 188 layers
2026-01-06 09:48:14,723 - INFO - Trainable parameters: 25,305,860
2026-01-06 09:48:14,733 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 09:49:51,351 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 09:51:28,947 - INFO - 
Evaluating fold performance...
2026-01-06 09:51:34,351 - INFO - 
Fold 5 Results:
2026-01-06 09:51:34,352 - INFO -   • Accuracy:  0.7261
2026-01-06 09:51:34,354 - INFO -   • Precision: 0.7228
2026-01-06 09:51:34,355 - INFO -   • Recall:    0.7261
2026-01-06 09:51:34,356 - INFO -   • F1-Score:  0.7007
2026-01-06 09:51:34,357 - INFO -   • Kappa:     0.6348
2026-01-06 09:51:35,037 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_5.keras
2026-01-06 09:51:35,457 - INFO - 
============================================================
2026-01-06 09:51:35,458 - INFO - K-Fold Cross-Validation Summary
2026-01-06 09:51:35,460 - INFO - ============================================================
2026-01-06 09:51:35,461 - INFO - Average Accuracy:  0.7273 ± 0.0072
2026-01-06 09:51:35,462 - INFO - Average Precision: 0.7524
2026-01-06 09:51:35,463 - INFO - Average Recall:    0.7273
2026-01-06 09:51:35,464 - INFO - Average F1-Score:  0.6923 ± 0.0152
2026-01-06 09:51:35,464 - INFO - Average Kappa:     0.6365
2026-01-06 09:51:35,467 - INFO - Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 09:51:35,468 - INFO - Generating K-Fold visualization plots...
2026-01-06 09:51:36,820 - INFO - K-fold analysis plot saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 09:51:36,828 - INFO - 
================================================================================
2026-01-06 09:51:36,829 - INFO - Evaluating on Test Set
2026-01-06 09:51:36,829 - INFO - ================================================================================

2026-01-06 09:51:36,968 - INFO - 
============================================================
2026-01-06 09:51:36,968 - INFO - Making Ensemble Predictions
2026-01-06 09:51:36,969 - INFO - ============================================================
2026-01-06 09:51:36,970 - INFO - Combining predictions from 5 models...
2026-01-06 09:51:36,971 - INFO - Loading model 1/5: model_fold_1.keras
2026-01-06 09:51:44,209 - INFO -   Predictions shape: (1183, 4)
2026-01-06 09:51:44,623 - INFO - Loading model 2/5: model_fold_2.keras
2026-01-06 09:51:50,565 - INFO -   Predictions shape: (1183, 4)
2026-01-06 09:51:50,732 - INFO - Loading model 3/5: model_fold_3.keras
2026-01-06 09:51:56,633 - INFO -   Predictions shape: (1183, 4)
2026-01-06 09:51:56,799 - INFO - Loading model 4/5: model_fold_4.keras
2026-01-06 09:52:02,688 - INFO -   Predictions shape: (1183, 4)
2026-01-06 09:52:02,855 - INFO - Loading model 5/5: model_fold_5.keras
2026-01-06 09:52:08,728 - INFO -   Predictions shape: (1183, 4)
2026-01-06 09:52:08,894 - INFO - Ensemble prediction shape: (1183, 4)
2026-01-06 09:52:08,901 - INFO - 
============================================================
2026-01-06 09:52:08,901 - INFO - ENSEMBLE TEST RESULTS
2026-01-06 09:52:08,903 - INFO - ============================================================
2026-01-06 09:52:08,903 - INFO - Accuracy:          0.5587 (55.87%)
2026-01-06 09:52:08,904 - INFO - Precision (Macro): 0.5701
2026-01-06 09:52:08,905 - INFO - Recall (Macro):    0.6395
2026-01-06 09:52:08,906 - INFO - F1-Score (Macro):  0.5018
2026-01-06 09:52:08,907 - INFO - Cohen's Kappa:     0.2260
2026-01-06 09:52:08,908 - INFO - MCC:               0.2674
2026-01-06 09:52:08,917 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.24      0.69      0.35        83
 Moderate Impairment       0.65      0.92      0.76        12
       No Impairment       0.63      0.86      0.73       640
Very Mild Impairment       0.76      0.09      0.17       448

            accuracy                           0.56      1183
           macro avg       0.57      0.64      0.50      1183
        weighted avg       0.65      0.56      0.49      1183

2026-01-06 09:52:08,922 - INFO - Metrics saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 09:52:09,717 - INFO - Confusion matrix saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2026-01-06 09:52:09,718 - INFO - 
================================================================================
2026-01-06 09:52:09,721 - INFO - Generating Grad-CAM++ Visualizations
2026-01-06 09:52:09,722 - INFO - ================================================================================

2026-01-06 09:52:11,890 - INFO - Processing 3 images for class: Mild Impairment
2026-01-06 09:52:16,208 - INFO - Processing 3 images for class: Moderate Impairment
2026-01-06 09:52:19,282 - INFO - Processing 3 images for class: No Impairment
2026-01-06 09:52:22,166 - INFO - Processing 3 images for class: Very Mild Impairment
2026-01-06 09:52:24,999 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus
2026-01-06 09:52:25,240 - INFO - 
================================================================================
2026-01-06 09:52:25,240 - INFO - Starting SHAP Analysis
2026-01-06 09:52:25,242 - INFO - ================================================================================

2026-01-06 09:52:25,243 - INFO - 
============================================================
2026-01-06 09:52:25,244 - INFO - Starting SHAP Analysis
2026-01-06 09:52:25,245 - INFO - ============================================================
2026-01-06 09:52:25,246 - INFO - Loading model from: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 09:52:27,509 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test
2026-01-06 09:52:27,519 - INFO - Found 1183 images from 4 classes
2026-01-06 09:52:27,520 - INFO -   • Mild Impairment: 83 images
2026-01-06 09:52:27,521 - INFO -   • Moderate Impairment: 12 images
2026-01-06 09:52:27,523 - INFO -   • No Impairment: 640 images
2026-01-06 09:52:27,523 - INFO -   • Very Mild Impairment: 448 images
2026-01-06 09:52:27,526 - INFO - Loading 50 background samples...
2026-01-06 09:52:27,589 - INFO - Loaded 50 background samples
2026-01-06 09:52:27,589 - INFO - Loading 10 test samples...
2026-01-06 09:52:27,601 - INFO - Loaded 10 test samples
2026-01-06 09:52:27,601 - INFO - Creating SHAP DeepExplainer (this may take a few minutes)...
2026-01-06 09:52:27,601 - INFO - Calculating SHAP values...
2026-01-06 09:53:34,285 - INFO - Generating SHAP visualization for: Mild Impairment
2026-01-06 09:53:34,892 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..149.061].
2026-01-06 09:53:34,901 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:34,909 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..120.061].
2026-01-06 09:53:34,918 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..147.061].
2026-01-06 09:53:34,928 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:34,939 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..148.061].
2026-01-06 09:53:34,948 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..148.061].
2026-01-06 09:53:34,957 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:34,965 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..142.061].
2026-01-06 09:53:34,974 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..149.061].
2026-01-06 09:53:35,660 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Mild_Impairment.png
2026-01-06 09:53:35,661 - INFO - Generating SHAP visualization for: Moderate Impairment
2026-01-06 09:53:36,108 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..149.061].
2026-01-06 09:53:36,116 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:36,125 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..120.061].
2026-01-06 09:53:36,133 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..147.061].
2026-01-06 09:53:36,143 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:36,152 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..148.061].
2026-01-06 09:53:36,161 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..148.061].
2026-01-06 09:53:36,169 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:36,179 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..142.061].
2026-01-06 09:53:36,191 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..149.061].
2026-01-06 09:53:36,858 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Moderate_Impairment.png
2026-01-06 09:53:36,858 - INFO - Generating SHAP visualization for: No Impairment
2026-01-06 09:53:37,272 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..149.061].
2026-01-06 09:53:37,281 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:37,289 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..120.061].
2026-01-06 09:53:37,296 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..147.061].
2026-01-06 09:53:37,304 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:37,312 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..148.061].
2026-01-06 09:53:37,321 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..148.061].
2026-01-06 09:53:37,329 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:37,337 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..142.061].
2026-01-06 09:53:37,350 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..149.061].
2026-01-06 09:53:38,031 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_No_Impairment.png
2026-01-06 09:53:38,032 - INFO - Generating SHAP visualization for: Very Mild Impairment
2026-01-06 09:53:38,647 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..149.061].
2026-01-06 09:53:38,656 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:38,663 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..120.061].
2026-01-06 09:53:38,671 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..147.061].
2026-01-06 09:53:38,678 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:38,686 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..148.061].
2026-01-06 09:53:38,694 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..148.061].
2026-01-06 09:53:38,702 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..151.061].
2026-01-06 09:53:38,711 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..142.061].
2026-01-06 09:53:38,719 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-123.68..149.061].
2026-01-06 09:53:39,383 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Very_Mild_Impairment.png
2026-01-06 09:53:40,356 - INFO - SHAP analysis complete. Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis
2026-01-06 09:53:40,586 - INFO - 
================================================================================
2026-01-06 09:53:40,586 - INFO - ANALYSIS COMPLETE!
2026-01-06 09:53:40,590 - INFO - ================================================================================

2026-01-06 09:53:40,590 - INFO - All results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced

2026-01-06 09:53:40,591 - INFO - Generated Files:
2026-01-06 09:53:40,592 - INFO -   K-Fold Analysis:  C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 09:53:40,593 - INFO -   K-Fold Results:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 09:53:40,593 - INFO -   Ensemble Results: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 09:53:40,594 - INFO -   Grad-CAM++ Viz:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus/
2026-01-06 09:53:40,595 - INFO -   SHAP Analysis:    C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis/
2026-01-06 09:53:40,596 - INFO -   Trained Models:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models/
2026-01-06 09:53:40,596 - INFO - 
================================================================================

2026-01-06 10:02:13,068 - INFO - ================================================================================
2026-01-06 10:02:13,068 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-06 10:02:13,069 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-06 10:02:13,069 - INFO - ================================================================================
2026-01-06 10:02:13,069 - INFO - Configuration:
2026-01-06 10:02:13,069 - INFO -   • Image Size: 224x224
2026-01-06 10:02:13,069 - INFO -   • Batch Size: 32
2026-01-06 10:02:13,069 - INFO -   • K-Folds: 5
2026-01-06 10:02:13,070 - INFO -   • Epochs: 2
2026-01-06 10:02:13,151 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-06 10:02:13,151 - INFO - Random seeds set (Strict determinism disabled for GPU compatibility)
2026-01-06 10:02:13,154 - INFO - Starting K-Fold Cross-Validation...
2026-01-06 10:02:13,155 - INFO - 
================================================================================
2026-01-06 10:02:13,156 - INFO - Starting 5-Fold Cross-Validation
2026-01-06 10:02:13,157 - INFO - ================================================================================

2026-01-06 10:02:13,157 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-06 10:02:13,213 - INFO - Found 10240 images from 4 classes
2026-01-06 10:02:13,213 - INFO -   • Mild Impairment: 2560 images
2026-01-06 10:02:13,216 - INFO -   • Moderate Impairment: 2560 images
2026-01-06 10:02:13,217 - INFO -   • No Impairment: 2560 images
2026-01-06 10:02:13,218 - INFO -   • Very Mild Impairment: 2560 images
2026-01-06 10:02:13,224 - INFO - 
============================================================
2026-01-06 10:02:13,224 - INFO - Training Fold 1/5
2026-01-06 10:02:13,225 - INFO - ============================================================
2026-01-06 10:02:13,349 - INFO - Training samples: 8192
2026-01-06 10:02:13,349 - INFO - Validation samples: 2048
2026-01-06 10:02:13,354 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:02:13,354 - INFO - Building model architecture...
2026-01-06 10:02:16,321 - INFO - Model created with 188 layers
2026-01-06 10:02:16,325 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:02:16,334 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:03:49,343 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:05:21,794 - INFO - 
Evaluating fold performance...
2026-01-06 10:05:27,471 - INFO - 
Fold 1 Results:
2026-01-06 10:05:27,471 - INFO -   • Accuracy:  0.7388
2026-01-06 10:05:27,472 - INFO -   • Precision: 0.7605
2026-01-06 10:05:27,472 - INFO -   • Recall:    0.7388
2026-01-06 10:05:27,473 - INFO -   • F1-Score:  0.7232
2026-01-06 10:05:27,474 - INFO -   • Kappa:     0.6517
2026-01-06 10:05:28,127 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 10:05:28,361 - INFO - 
============================================================
2026-01-06 10:05:28,361 - INFO - Training Fold 2/5
2026-01-06 10:05:28,363 - INFO - ============================================================
2026-01-06 10:05:28,540 - INFO - Training samples: 8192
2026-01-06 10:05:28,541 - INFO - Validation samples: 2048
2026-01-06 10:05:28,544 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:05:28,545 - INFO - Building model architecture...
2026-01-06 10:05:29,926 - INFO - Model created with 188 layers
2026-01-06 10:05:29,929 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:05:29,940 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:07:02,281 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:08:36,425 - INFO - 
Evaluating fold performance...
2026-01-06 10:08:42,195 - INFO - 
Fold 2 Results:
2026-01-06 10:08:42,195 - INFO -   • Accuracy:  0.7363
2026-01-06 10:08:42,198 - INFO -   • Precision: 0.7422
2026-01-06 10:08:42,199 - INFO -   • Recall:    0.7363
2026-01-06 10:08:42,200 - INFO -   • F1-Score:  0.7184
2026-01-06 10:08:42,201 - INFO -   • Kappa:     0.6484
2026-01-06 10:08:42,872 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-06 10:08:43,297 - INFO - 
============================================================
2026-01-06 10:08:43,298 - INFO - Training Fold 3/5
2026-01-06 10:08:43,301 - INFO - ============================================================
2026-01-06 10:08:43,479 - INFO - Training samples: 8192
2026-01-06 10:08:43,479 - INFO - Validation samples: 2048
2026-01-06 10:08:43,484 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:08:43,484 - INFO - Building model architecture...
2026-01-06 10:08:44,937 - INFO - Model created with 188 layers
2026-01-06 10:08:44,941 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:08:44,950 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:10:22,798 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:12:01,000 - INFO - 
Evaluating fold performance...
2026-01-06 10:12:06,711 - INFO - 
Fold 3 Results:
2026-01-06 10:12:06,712 - INFO -   • Accuracy:  0.6997
2026-01-06 10:12:06,715 - INFO -   • Precision: 0.7202
2026-01-06 10:12:06,716 - INFO -   • Recall:    0.6997
2026-01-06 10:12:06,717 - INFO -   • F1-Score:  0.6627
2026-01-06 10:12:06,718 - INFO -   • Kappa:     0.5996
2026-01-06 10:12:07,334 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_3.keras
2026-01-06 10:12:07,760 - INFO - 
============================================================
2026-01-06 10:12:07,761 - INFO - Training Fold 4/5
2026-01-06 10:12:07,764 - INFO - ============================================================
2026-01-06 10:12:07,952 - INFO - Training samples: 8192
2026-01-06 10:12:07,952 - INFO - Validation samples: 2048
2026-01-06 10:12:07,955 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:12:07,955 - INFO - Building model architecture...
2026-01-06 10:12:09,370 - INFO - Model created with 188 layers
2026-01-06 10:12:09,373 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:12:09,383 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:13:46,828 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:15:27,256 - INFO - 
Evaluating fold performance...
2026-01-06 10:15:33,060 - INFO - 
Fold 4 Results:
2026-01-06 10:15:33,061 - INFO -   • Accuracy:  0.7485
2026-01-06 10:15:33,063 - INFO -   • Precision: 0.7379
2026-01-06 10:15:33,065 - INFO -   • Recall:    0.7485
2026-01-06 10:15:33,066 - INFO -   • F1-Score:  0.7391
2026-01-06 10:15:33,066 - INFO -   • Kappa:     0.6647
2026-01-06 10:15:33,686 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_4.keras
2026-01-06 10:15:34,125 - INFO - 
============================================================
2026-01-06 10:15:34,125 - INFO - Training Fold 5/5
2026-01-06 10:15:34,131 - INFO - ============================================================
2026-01-06 10:15:34,313 - INFO - Training samples: 8192
2026-01-06 10:15:34,313 - INFO - Validation samples: 2048
2026-01-06 10:15:34,318 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:15:34,318 - INFO - Building model architecture...
2026-01-06 10:15:35,728 - INFO - Model created with 188 layers
2026-01-06 10:15:35,731 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:15:35,742 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:17:15,370 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:18:55,860 - INFO - 
Evaluating fold performance...
2026-01-06 10:19:01,588 - INFO - 
Fold 5 Results:
2026-01-06 10:19:01,589 - INFO -   • Accuracy:  0.7451
2026-01-06 10:19:01,592 - INFO -   • Precision: 0.7780
2026-01-06 10:19:01,593 - INFO -   • Recall:    0.7451
2026-01-06 10:19:01,594 - INFO -   • F1-Score:  0.7227
2026-01-06 10:19:01,595 - INFO -   • Kappa:     0.6602
2026-01-06 10:19:02,269 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_5.keras
2026-01-06 10:19:02,702 - INFO - 
============================================================
2026-01-06 10:19:02,702 - INFO - K-Fold Cross-Validation Summary
2026-01-06 10:19:02,706 - INFO - ============================================================
2026-01-06 10:19:02,706 - INFO - Average Accuracy:  0.7337 ± 0.0175
2026-01-06 10:19:02,707 - INFO - Average Precision: 0.7478
2026-01-06 10:19:02,708 - INFO - Average Recall:    0.7337
2026-01-06 10:19:02,709 - INFO - Average F1-Score:  0.7132 ± 0.0262
2026-01-06 10:19:02,709 - INFO - Average Kappa:     0.6449
2026-01-06 10:19:02,712 - INFO - Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 10:19:02,713 - INFO - Generating K-Fold visualization plots...
2026-01-06 10:19:04,088 - INFO - K-fold analysis plot saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 10:19:04,097 - INFO - 
================================================================================
2026-01-06 10:19:04,097 - INFO - Evaluating on Test Set
2026-01-06 10:19:04,098 - INFO - ================================================================================

2026-01-06 10:19:04,222 - INFO - 
============================================================
2026-01-06 10:19:04,223 - INFO - Making Ensemble Predictions
2026-01-06 10:19:04,224 - INFO - ============================================================
2026-01-06 10:19:04,225 - INFO - Combining predictions from 5 models...
2026-01-06 10:19:04,226 - INFO - Loading model 1/5: model_fold_1.keras
2026-01-06 10:19:10,877 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:19:11,308 - INFO - Loading model 2/5: model_fold_2.keras
2026-01-06 10:19:17,430 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:19:17,604 - INFO - Loading model 3/5: model_fold_3.keras
2026-01-06 10:19:23,812 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:19:23,985 - INFO - Loading model 4/5: model_fold_4.keras
2026-01-06 10:19:30,366 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:19:30,541 - INFO - Loading model 5/5: model_fold_5.keras
2026-01-06 10:19:36,774 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:19:36,950 - INFO - Ensemble prediction shape: (1183, 4)
2026-01-06 10:19:36,957 - INFO - 
============================================================
2026-01-06 10:19:36,957 - INFO - ENSEMBLE TEST RESULTS
2026-01-06 10:19:36,958 - INFO - ============================================================
2026-01-06 10:19:36,959 - INFO - Accuracy:          0.5866 (58.66%)
2026-01-06 10:19:36,960 - INFO - Precision (Macro): 0.5700
2026-01-06 10:19:36,961 - INFO - Recall (Macro):    0.6119
2026-01-06 10:19:36,962 - INFO - F1-Score (Macro):  0.5334
2026-01-06 10:19:36,963 - INFO - Cohen's Kappa:     0.2738
2026-01-06 10:19:36,964 - INFO - MCC:               0.3030
2026-01-06 10:19:36,974 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.25      0.65      0.36        83
 Moderate Impairment       0.69      0.75      0.72        12
       No Impairment       0.66      0.84      0.74       640
Very Mild Impairment       0.68      0.20      0.31       448

            accuracy                           0.59      1183
           macro avg       0.57      0.61      0.53      1183
        weighted avg       0.64      0.59      0.55      1183

2026-01-06 10:19:36,976 - INFO - Metrics saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 10:19:37,847 - INFO - Confusion matrix saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2026-01-06 10:19:37,848 - INFO - 
================================================================================
2026-01-06 10:19:37,851 - INFO - Generating Grad-CAM++ Visualizations
2026-01-06 10:19:37,852 - INFO - ================================================================================

2026-01-06 10:19:40,182 - INFO - Processing 3 images for class: Mild Impairment
2026-01-06 10:19:44,690 - INFO - Processing 3 images for class: Moderate Impairment
2026-01-06 10:19:47,873 - INFO - Processing 3 images for class: No Impairment
2026-01-06 10:19:50,827 - INFO - Processing 3 images for class: Very Mild Impairment
2026-01-06 10:19:53,767 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus
2026-01-06 10:19:54,006 - INFO - 
================================================================================
2026-01-06 10:19:54,006 - INFO - Starting SHAP Analysis
2026-01-06 10:19:54,009 - INFO - ================================================================================

2026-01-06 10:19:54,010 - INFO - 
============================================================
2026-01-06 10:19:54,011 - INFO - Starting SHAP Analysis
2026-01-06 10:19:54,012 - INFO - ============================================================
2026-01-06 10:19:54,013 - INFO - Loading model from: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 10:19:57,732 - INFO - Created logits model (softmax replaced with linear activation)
2026-01-06 10:19:57,733 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test
2026-01-06 10:19:57,739 - INFO - Found 1183 images from 4 classes
2026-01-06 10:19:57,739 - INFO -   • Mild Impairment: 83 images
2026-01-06 10:19:57,739 - INFO -   • Moderate Impairment: 12 images
2026-01-06 10:19:57,740 - INFO -   • No Impairment: 640 images
2026-01-06 10:19:57,740 - INFO -   • Very Mild Impairment: 448 images
2026-01-06 10:19:57,740 - INFO - Loading 50 background samples...
2026-01-06 10:19:57,802 - INFO - Loaded 50 background samples
2026-01-06 10:19:57,802 - INFO - Loading 10 test samples...
2026-01-06 10:19:57,820 - INFO - Loaded 10 test samples
2026-01-06 10:19:57,821 - INFO - Creating SHAP GradientExplainer...
2026-01-06 10:19:57,822 - INFO - Calculating SHAP values...
2026-01-06 10:21:13,798 - INFO - Generating SHAP visualization for: Mild Impairment
2026-01-06 10:21:15,059 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Mild_Impairment.png
2026-01-06 10:21:15,060 - INFO - Generating SHAP visualization for: Moderate Impairment
2026-01-06 10:21:16,288 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Moderate_Impairment.png
2026-01-06 10:21:16,288 - INFO - Generating SHAP visualization for: No Impairment
2026-01-06 10:21:17,748 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_No_Impairment.png
2026-01-06 10:21:17,749 - INFO - Generating SHAP visualization for: Very Mild Impairment
2026-01-06 10:21:18,965 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Very_Mild_Impairment.png
2026-01-06 10:21:19,922 - INFO - SHAP analysis complete. Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis
2026-01-06 10:21:20,190 - INFO - 
================================================================================
2026-01-06 10:21:20,190 - INFO - ANALYSIS COMPLETE!
2026-01-06 10:21:20,193 - INFO - ================================================================================

2026-01-06 10:21:20,194 - INFO - All results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced

2026-01-06 10:21:20,194 - INFO - Generated Files:
2026-01-06 10:21:20,195 - INFO -   K-Fold Analysis:  C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 10:21:20,196 - INFO -   K-Fold Results:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 10:21:20,197 - INFO -   Ensemble Results: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 10:21:20,198 - INFO -   Grad-CAM++ Viz:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus/
2026-01-06 10:21:20,198 - INFO -   SHAP Analysis:    C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis/
2026-01-06 10:21:20,199 - INFO -   Trained Models:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models/
2026-01-06 10:21:20,200 - INFO - 
================================================================================

2026-01-06 10:36:22,715 - INFO - ================================================================================
2026-01-06 10:36:22,715 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-06 10:36:22,717 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-06 10:36:22,718 - INFO - ================================================================================
2026-01-06 10:36:22,719 - INFO - Configuration:
2026-01-06 10:36:22,719 - INFO -   • Image Size: 224x224
2026-01-06 10:36:22,720 - INFO -   • Batch Size: 32
2026-01-06 10:36:22,721 - INFO -   • K-Folds: 5
2026-01-06 10:36:22,721 - INFO -   • Epochs: 2
2026-01-06 10:36:22,798 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-06 10:36:22,798 - INFO - Random seeds set (Strict determinism disabled for GPU compatibility)
2026-01-06 10:36:22,801 - INFO - Starting K-Fold Cross-Validation...
2026-01-06 10:36:22,802 - INFO - 
================================================================================
2026-01-06 10:36:22,803 - INFO - Starting 5-Fold Cross-Validation
2026-01-06 10:36:22,804 - INFO - ================================================================================

2026-01-06 10:36:22,805 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-06 10:36:22,864 - INFO - Found 10240 images from 4 classes
2026-01-06 10:36:22,864 - INFO -   • Mild Impairment: 2560 images
2026-01-06 10:36:22,867 - INFO -   • Moderate Impairment: 2560 images
2026-01-06 10:36:22,868 - INFO -   • No Impairment: 2560 images
2026-01-06 10:36:22,869 - INFO -   • Very Mild Impairment: 2560 images
2026-01-06 10:36:22,873 - INFO - 
============================================================
2026-01-06 10:36:22,873 - INFO - Training Fold 1/5
2026-01-06 10:36:22,874 - INFO - ============================================================
2026-01-06 10:36:22,999 - INFO - Training samples: 8192
2026-01-06 10:36:22,999 - INFO - Validation samples: 2048
2026-01-06 10:36:23,005 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:36:23,006 - INFO - Building model architecture...
2026-01-06 10:36:25,761 - INFO - Model created with 188 layers
2026-01-06 10:36:25,764 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:36:25,773 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:37:58,486 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:39:30,901 - INFO - 
Evaluating fold performance...
2026-01-06 10:39:36,480 - INFO - 
Fold 1 Results:
2026-01-06 10:39:36,480 - INFO -   • Accuracy:  0.7666
2026-01-06 10:39:36,483 - INFO -   • Precision: 0.7806
2026-01-06 10:39:36,484 - INFO -   • Recall:    0.7666
2026-01-06 10:39:36,485 - INFO -   • F1-Score:  0.7545
2026-01-06 10:39:36,486 - INFO -   • Kappa:     0.6888
2026-01-06 10:39:37,135 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 10:39:37,363 - INFO - 
============================================================
2026-01-06 10:39:37,363 - INFO - Training Fold 2/5
2026-01-06 10:39:37,366 - INFO - ============================================================
2026-01-06 10:39:37,546 - INFO - Training samples: 8192
2026-01-06 10:39:37,546 - INFO - Validation samples: 2048
2026-01-06 10:39:37,550 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:39:37,550 - INFO - Building model architecture...
2026-01-06 10:39:38,973 - INFO - Model created with 188 layers
2026-01-06 10:39:38,976 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:39:38,986 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:41:11,414 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:42:44,120 - INFO - 
Evaluating fold performance...
2026-01-06 10:42:49,703 - INFO - 
Fold 2 Results:
2026-01-06 10:42:49,703 - INFO -   • Accuracy:  0.7563
2026-01-06 10:42:49,706 - INFO -   • Precision: 0.7687
2026-01-06 10:42:49,707 - INFO -   • Recall:    0.7563
2026-01-06 10:42:49,708 - INFO -   • F1-Score:  0.7350
2026-01-06 10:42:49,709 - INFO -   • Kappa:     0.6751
2026-01-06 10:42:50,325 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-06 10:42:50,761 - INFO - 
============================================================
2026-01-06 10:42:50,761 - INFO - Training Fold 3/5
2026-01-06 10:42:50,764 - INFO - ============================================================
2026-01-06 10:42:50,938 - INFO - Training samples: 8192
2026-01-06 10:42:50,938 - INFO - Validation samples: 2048
2026-01-06 10:42:50,947 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:42:50,947 - INFO - Building model architecture...
2026-01-06 10:42:52,291 - INFO - Model created with 188 layers
2026-01-06 10:42:52,294 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:42:52,303 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:44:26,579 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:46:02,275 - INFO - 
Evaluating fold performance...
2026-01-06 10:46:07,944 - INFO - 
Fold 3 Results:
2026-01-06 10:46:07,944 - INFO -   • Accuracy:  0.7456
2026-01-06 10:46:07,947 - INFO -   • Precision: 0.7410
2026-01-06 10:46:07,948 - INFO -   • Recall:    0.7456
2026-01-06 10:46:07,949 - INFO -   • F1-Score:  0.7354
2026-01-06 10:46:07,950 - INFO -   • Kappa:     0.6608
2026-01-06 10:46:08,613 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_3.keras
2026-01-06 10:46:09,025 - INFO - 
============================================================
2026-01-06 10:46:09,025 - INFO - Training Fold 4/5
2026-01-06 10:46:09,030 - INFO - ============================================================
2026-01-06 10:46:09,207 - INFO - Training samples: 8192
2026-01-06 10:46:09,207 - INFO - Validation samples: 2048
2026-01-06 10:46:09,212 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:46:09,212 - INFO - Building model architecture...
2026-01-06 10:46:10,590 - INFO - Model created with 188 layers
2026-01-06 10:46:10,593 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:46:10,603 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:47:45,916 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:49:22,112 - INFO - 
Evaluating fold performance...
2026-01-06 10:49:27,774 - INFO - 
Fold 4 Results:
2026-01-06 10:49:27,775 - INFO -   • Accuracy:  0.6890
2026-01-06 10:49:27,778 - INFO -   • Precision: 0.7310
2026-01-06 10:49:27,779 - INFO -   • Recall:    0.6890
2026-01-06 10:49:27,780 - INFO -   • F1-Score:  0.6453
2026-01-06 10:49:27,781 - INFO -   • Kappa:     0.5853
2026-01-06 10:49:28,398 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_4.keras
2026-01-06 10:49:28,830 - INFO - 
============================================================
2026-01-06 10:49:28,830 - INFO - Training Fold 5/5
2026-01-06 10:49:28,834 - INFO - ============================================================
2026-01-06 10:49:29,010 - INFO - Training samples: 8192
2026-01-06 10:49:29,010 - INFO - Validation samples: 2048
2026-01-06 10:49:29,015 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 10:49:29,015 - INFO - Building model architecture...
2026-01-06 10:49:30,392 - INFO - Model created with 188 layers
2026-01-06 10:49:30,400 - INFO - Trainable parameters: 25,305,860
2026-01-06 10:49:30,418 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 10:51:07,480 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 10:52:43,866 - INFO - 
Evaluating fold performance...
2026-01-06 10:52:49,552 - INFO - 
Fold 5 Results:
2026-01-06 10:52:49,552 - INFO -   • Accuracy:  0.6919
2026-01-06 10:52:49,557 - INFO -   • Precision: 0.7063
2026-01-06 10:52:49,558 - INFO -   • Recall:    0.6919
2026-01-06 10:52:49,558 - INFO -   • F1-Score:  0.6596
2026-01-06 10:52:49,559 - INFO -   • Kappa:     0.5892
2026-01-06 10:52:50,209 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_5.keras
2026-01-06 10:52:50,630 - INFO - 
============================================================
2026-01-06 10:52:50,630 - INFO - K-Fold Cross-Validation Summary
2026-01-06 10:52:50,633 - INFO - ============================================================
2026-01-06 10:52:50,634 - INFO - Average Accuracy:  0.7299 ± 0.0329
2026-01-06 10:52:50,635 - INFO - Average Precision: 0.7455
2026-01-06 10:52:50,636 - INFO - Average Recall:    0.7299
2026-01-06 10:52:50,637 - INFO - Average F1-Score:  0.7060 ± 0.0445
2026-01-06 10:52:50,638 - INFO - Average Kappa:     0.6398
2026-01-06 10:52:50,640 - INFO - Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 10:52:50,641 - INFO - Generating K-Fold visualization plots...
2026-01-06 10:52:51,985 - INFO - K-fold analysis plot saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 10:52:51,993 - INFO - 
================================================================================
2026-01-06 10:52:51,994 - INFO - Evaluating on Test Set
2026-01-06 10:52:51,994 - INFO - ================================================================================

2026-01-06 10:52:52,155 - INFO - 
============================================================
2026-01-06 10:52:52,155 - INFO - Making Ensemble Predictions
2026-01-06 10:52:52,158 - INFO - ============================================================
2026-01-06 10:52:52,159 - INFO - Combining predictions from 5 models...
2026-01-06 10:52:52,160 - INFO - Loading model 1/5: model_fold_1.keras
2026-01-06 10:52:58,828 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:52:59,249 - INFO - Loading model 2/5: model_fold_2.keras
2026-01-06 10:53:05,317 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:53:05,484 - INFO - Loading model 3/5: model_fold_3.keras
2026-01-06 10:53:11,464 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:53:11,627 - INFO - Loading model 4/5: model_fold_4.keras
2026-01-06 10:53:17,695 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:53:17,865 - INFO - Loading model 5/5: model_fold_5.keras
2026-01-06 10:53:23,940 - INFO -   Predictions shape: (1183, 4)
2026-01-06 10:53:24,104 - INFO - Ensemble prediction shape: (1183, 4)
2026-01-06 10:53:24,111 - INFO - 
============================================================
2026-01-06 10:53:24,111 - INFO - ENSEMBLE TEST RESULTS
2026-01-06 10:53:24,113 - INFO - ============================================================
2026-01-06 10:53:24,115 - INFO - Accuracy:          0.5782 (57.82%)
2026-01-06 10:53:24,117 - INFO - Precision (Macro): 0.6141
2026-01-06 10:53:24,123 - INFO - Recall (Macro):    0.6590
2026-01-06 10:53:24,124 - INFO - F1-Score (Macro):  0.5663
2026-01-06 10:53:24,127 - INFO - Cohen's Kappa:     0.2813
2026-01-06 10:53:24,129 - INFO - MCC:               0.3117
2026-01-06 10:53:24,139 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.22      0.70      0.33        83
 Moderate Impairment       0.85      0.92      0.88        12
       No Impairment       0.67      0.82      0.74       640
Very Mild Impairment       0.72      0.20      0.31       448

            accuracy                           0.58      1183
           macro avg       0.61      0.66      0.57      1183
        weighted avg       0.66      0.58      0.55      1183

2026-01-06 10:53:24,141 - INFO - Metrics saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 10:53:24,900 - INFO - Confusion matrix saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2026-01-06 10:53:24,901 - INFO - 
================================================================================
2026-01-06 10:53:24,904 - INFO - Generating Grad-CAM++ Visualizations
2026-01-06 10:53:24,905 - INFO - ================================================================================

2026-01-06 10:53:27,065 - INFO - Processing 3 images for class: Mild Impairment
2026-01-06 10:53:31,485 - INFO - Processing 3 images for class: Moderate Impairment
2026-01-06 10:53:34,681 - INFO - Processing 3 images for class: No Impairment
2026-01-06 10:53:37,628 - INFO - Processing 3 images for class: Very Mild Impairment
2026-01-06 10:53:40,536 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus
2026-01-06 10:53:40,775 - INFO - 
================================================================================
2026-01-06 10:53:40,776 - INFO - Starting SHAP Analysis
2026-01-06 10:53:40,779 - INFO - ================================================================================

2026-01-06 10:53:40,780 - INFO - 
============================================================
2026-01-06 10:53:40,780 - INFO - Starting SHAP Analysis
2026-01-06 10:53:40,781 - INFO - ============================================================
2026-01-06 10:53:40,781 - INFO - Loading model from: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 10:53:44,427 - INFO - Created logits model (softmax replaced with linear activation)
2026-01-06 10:53:44,428 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test
2026-01-06 10:53:44,436 - INFO - Found 1183 images from 4 classes
2026-01-06 10:53:44,436 - INFO -   • Mild Impairment: 83 images
2026-01-06 10:53:44,436 - INFO -   • Moderate Impairment: 12 images
2026-01-06 10:53:44,437 - INFO -   • No Impairment: 640 images
2026-01-06 10:53:44,438 - INFO -   • Very Mild Impairment: 448 images
2026-01-06 10:53:44,440 - INFO - Loading 50 background samples...
2026-01-06 10:53:44,522 - INFO - Loaded 50 background samples
2026-01-06 10:53:44,522 - INFO - Loading 10 test samples...
2026-01-06 10:53:44,538 - INFO - Loaded 10 test samples
2026-01-06 10:53:44,539 - INFO - Creating SHAP GradientExplainer...
2026-01-06 10:53:44,540 - INFO - Calculating SHAP values...
2026-01-06 10:54:54,694 - INFO - SHAP Values Type: <class 'numpy.ndarray'>
2026-01-06 10:54:54,706 - INFO - SHAP Values Shape: (10, 224, 224, 3, 4)
2026-01-06 10:54:54,706 - INFO - Test Samples Display Shape: (10, 224, 224, 3)
2026-01-06 10:54:54,707 - INFO - Generating SHAP visualization for: Mild Impairment
2026-01-06 10:54:54,730 - INFO - Total absolute attribution for Mild Impairment: 8.0645e+03
2026-01-06 10:54:55,196 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.060600169003009796..0.05321844946593046].
2026-01-06 10:54:55,245 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.037130557000637054..0.028251075418666005].
2026-01-06 10:54:55,292 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.054450707510113716..0.05206639412790537].
2026-01-06 10:54:55,341 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.04686727002263069..0.0440280013717711].
2026-01-06 10:54:55,388 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.04545061010867357..0.05424462305381894].
2026-01-06 10:54:55,437 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.03409186843782663..0.04461222235113382].
2026-01-06 10:54:55,485 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.032770608086138964..0.047013993142172694].
2026-01-06 10:54:55,534 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.03607162833213806..0.0356180474627763].
2026-01-06 10:54:55,583 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.06039135716855526..0.06601455807685852].
2026-01-06 10:54:55,631 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.05447220243513584..0.05983600951731205].
2026-01-06 10:54:57,007 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Mild_Impairment.png
2026-01-06 10:54:57,008 - INFO - Generating SHAP visualization for: Moderate Impairment
2026-01-06 10:54:57,037 - INFO - Total absolute attribution for Moderate Impairment: 8.0645e+03
2026-01-06 10:54:57,461 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.060600169003009796..0.05321844946593046].
2026-01-06 10:54:57,509 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.037130557000637054..0.028251075418666005].
2026-01-06 10:54:57,559 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.054450707510113716..0.05206639412790537].
2026-01-06 10:54:57,609 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.04686727002263069..0.0440280013717711].
2026-01-06 10:54:57,658 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.04545061010867357..0.05424462305381894].
2026-01-06 10:54:57,708 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.03409186843782663..0.04461222235113382].
2026-01-06 10:54:57,761 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.032770608086138964..0.047013993142172694].
2026-01-06 10:54:57,815 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.03607162833213806..0.0356180474627763].
2026-01-06 10:54:57,869 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.06039135716855526..0.06601455807685852].
2026-01-06 10:54:57,922 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.05447220243513584..0.05983600951731205].
2026-01-06 10:54:59,294 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Moderate_Impairment.png
2026-01-06 10:54:59,294 - INFO - Generating SHAP visualization for: No Impairment
2026-01-06 10:54:59,321 - INFO - Total absolute attribution for No Impairment: 8.0645e+03
2026-01-06 10:54:59,994 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.060600169003009796..0.05321844946593046].
2026-01-06 10:55:00,044 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.037130557000637054..0.028251075418666005].
2026-01-06 10:55:00,096 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.054450707510113716..0.05206639412790537].
2026-01-06 10:55:00,146 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.04686727002263069..0.0440280013717711].
2026-01-06 10:55:00,195 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.04545061010867357..0.05424462305381894].
2026-01-06 10:55:00,244 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.03409186843782663..0.04461222235113382].
2026-01-06 10:55:00,292 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.032770608086138964..0.047013993142172694].
2026-01-06 10:55:00,340 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.03607162833213806..0.0356180474627763].
2026-01-06 10:55:00,388 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.06039135716855526..0.06601455807685852].
2026-01-06 10:55:00,436 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.05447220243513584..0.05983600951731205].
2026-01-06 10:55:01,780 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_No_Impairment.png
2026-01-06 10:55:01,781 - INFO - Generating SHAP visualization for: Very Mild Impairment
2026-01-06 10:55:01,806 - INFO - Total absolute attribution for Very Mild Impairment: 8.0645e+03
2026-01-06 10:55:02,271 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.060600169003009796..0.05321844946593046].
2026-01-06 10:55:02,320 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.037130557000637054..0.028251075418666005].
2026-01-06 10:55:02,368 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.054450707510113716..0.05206639412790537].
2026-01-06 10:55:02,416 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.04686727002263069..0.0440280013717711].
2026-01-06 10:55:02,464 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.04545061010867357..0.05424462305381894].
2026-01-06 10:55:02,511 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.03409186843782663..0.04461222235113382].
2026-01-06 10:55:02,561 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.032770608086138964..0.047013993142172694].
2026-01-06 10:55:02,610 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.03607162833213806..0.0356180474627763].
2026-01-06 10:55:02,659 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.06039135716855526..0.06601455807685852].
2026-01-06 10:55:02,709 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.05447220243513584..0.05983600951731205].
2026-01-06 10:55:04,057 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Very_Mild_Impairment.png
2026-01-06 10:55:04,993 - INFO - SHAP analysis complete. Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis
2026-01-06 10:55:05,258 - INFO - 
================================================================================
2026-01-06 10:55:05,259 - INFO - ANALYSIS COMPLETE!
2026-01-06 10:55:05,262 - INFO - ================================================================================

2026-01-06 10:55:05,263 - INFO - All results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced

2026-01-06 10:55:05,264 - INFO - Generated Files:
2026-01-06 10:55:05,265 - INFO -   K-Fold Analysis:  C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 10:55:05,265 - INFO -   K-Fold Results:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 10:55:05,266 - INFO -   Ensemble Results: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 10:55:05,267 - INFO -   Grad-CAM++ Viz:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus/
2026-01-06 10:55:05,268 - INFO -   SHAP Analysis:    C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis/
2026-01-06 10:55:05,268 - INFO -   Trained Models:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models/
2026-01-06 10:55:05,269 - INFO - 
================================================================================

2026-01-06 11:06:17,204 - INFO - ================================================================================
2026-01-06 11:06:17,204 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-06 11:06:17,207 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-06 11:06:17,208 - INFO - ================================================================================
2026-01-06 11:06:17,208 - INFO - Configuration:
2026-01-06 11:06:17,209 - INFO -   • Image Size: 224x224
2026-01-06 11:06:17,210 - INFO -   • Batch Size: 32
2026-01-06 11:06:17,210 - INFO -   • K-Folds: 5
2026-01-06 11:06:17,212 - INFO -   • Epochs: 2
2026-01-06 11:06:17,327 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-06 11:06:17,327 - INFO - Random seeds set (Strict determinism disabled for GPU compatibility)
2026-01-06 11:06:17,330 - INFO - Starting K-Fold Cross-Validation...
2026-01-06 11:06:17,332 - INFO - 
================================================================================
2026-01-06 11:06:17,333 - INFO - Starting 5-Fold Cross-Validation
2026-01-06 11:06:17,336 - INFO - ================================================================================

2026-01-06 11:06:17,338 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-06 11:06:17,397 - INFO - Found 10240 images from 4 classes
2026-01-06 11:06:17,397 - INFO -   • Mild Impairment: 2560 images
2026-01-06 11:06:17,400 - INFO -   • Moderate Impairment: 2560 images
2026-01-06 11:06:17,402 - INFO -   • No Impairment: 2560 images
2026-01-06 11:06:17,402 - INFO -   • Very Mild Impairment: 2560 images
2026-01-06 11:06:17,408 - INFO - 
============================================================
2026-01-06 11:06:17,408 - INFO - Training Fold 1/5
2026-01-06 11:06:17,409 - INFO - ============================================================
2026-01-06 11:06:17,534 - INFO - Training samples: 8192
2026-01-06 11:06:17,535 - INFO - Validation samples: 2048
2026-01-06 11:06:17,539 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:06:17,540 - INFO - Building model architecture...
2026-01-06 11:06:20,296 - INFO - Model created with 188 layers
2026-01-06 11:06:20,299 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:06:20,308 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:07:52,572 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:09:24,306 - INFO - 
Evaluating fold performance...
2026-01-06 11:09:30,013 - INFO - 
Fold 1 Results:
2026-01-06 11:09:30,014 - INFO -   • Accuracy:  0.7236
2026-01-06 11:09:30,017 - INFO -   • Precision: 0.7192
2026-01-06 11:09:30,018 - INFO -   • Recall:    0.7236
2026-01-06 11:09:30,019 - INFO -   • F1-Score:  0.6998
2026-01-06 11:09:30,020 - INFO -   • Kappa:     0.6315
2026-01-06 11:09:30,656 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 11:09:30,891 - INFO - 
============================================================
2026-01-06 11:09:30,891 - INFO - Training Fold 2/5
2026-01-06 11:09:30,894 - INFO - ============================================================
2026-01-06 11:09:31,074 - INFO - Training samples: 8192
2026-01-06 11:09:31,074 - INFO - Validation samples: 2048
2026-01-06 11:09:31,079 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:09:31,079 - INFO - Building model architecture...
2026-01-06 11:09:32,511 - INFO - Model created with 188 layers
2026-01-06 11:09:32,514 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:09:32,525 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:11:03,602 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:12:37,030 - INFO - 
Evaluating fold performance...
2026-01-06 11:12:42,696 - INFO - 
Fold 2 Results:
2026-01-06 11:12:42,697 - INFO -   • Accuracy:  0.7783
2026-01-06 11:12:42,700 - INFO -   • Precision: 0.7786
2026-01-06 11:12:42,701 - INFO -   • Recall:    0.7783
2026-01-06 11:12:42,702 - INFO -   • F1-Score:  0.7748
2026-01-06 11:12:42,703 - INFO -   • Kappa:     0.7044
2026-01-06 11:12:43,439 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-06 11:12:43,893 - INFO - 
============================================================
2026-01-06 11:12:43,893 - INFO - Training Fold 3/5
2026-01-06 11:12:43,896 - INFO - ============================================================
2026-01-06 11:12:44,087 - INFO - Training samples: 8192
2026-01-06 11:12:44,088 - INFO - Validation samples: 2048
2026-01-06 11:12:44,092 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:12:44,093 - INFO - Building model architecture...
2026-01-06 11:12:45,572 - INFO - Model created with 188 layers
2026-01-06 11:12:45,575 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:12:45,585 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:14:20,227 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:15:54,510 - INFO - 
Evaluating fold performance...
2026-01-06 11:16:00,281 - INFO - 
Fold 3 Results:
2026-01-06 11:16:00,281 - INFO -   • Accuracy:  0.7437
2026-01-06 11:16:00,285 - INFO -   • Precision: 0.7820
2026-01-06 11:16:00,286 - INFO -   • Recall:    0.7437
2026-01-06 11:16:00,286 - INFO -   • F1-Score:  0.7114
2026-01-06 11:16:00,287 - INFO -   • Kappa:     0.6582
2026-01-06 11:16:00,932 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_3.keras
2026-01-06 11:16:01,358 - INFO - 
============================================================
2026-01-06 11:16:01,358 - INFO - Training Fold 4/5
2026-01-06 11:16:01,362 - INFO - ============================================================
2026-01-06 11:16:01,552 - INFO - Training samples: 8192
2026-01-06 11:16:01,553 - INFO - Validation samples: 2048
2026-01-06 11:16:01,557 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:16:01,558 - INFO - Building model architecture...
2026-01-06 11:16:02,992 - INFO - Model created with 188 layers
2026-01-06 11:16:02,995 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:16:03,005 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:17:37,741 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:19:13,806 - INFO - 
Evaluating fold performance...
2026-01-06 11:19:19,525 - INFO - 
Fold 4 Results:
2026-01-06 11:19:19,526 - INFO -   • Accuracy:  0.7388
2026-01-06 11:19:19,526 - INFO -   • Precision: 0.7364
2026-01-06 11:19:19,526 - INFO -   • Recall:    0.7388
2026-01-06 11:19:19,528 - INFO -   • F1-Score:  0.7211
2026-01-06 11:19:19,529 - INFO -   • Kappa:     0.6517
2026-01-06 11:19:20,163 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_4.keras
2026-01-06 11:19:20,582 - INFO - 
============================================================
2026-01-06 11:19:20,582 - INFO - Training Fold 5/5
2026-01-06 11:19:20,586 - INFO - ============================================================
2026-01-06 11:19:20,768 - INFO - Training samples: 8192
2026-01-06 11:19:20,769 - INFO - Validation samples: 2048
2026-01-06 11:19:20,774 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:19:20,775 - INFO - Building model architecture...
2026-01-06 11:19:22,220 - INFO - Model created with 188 layers
2026-01-06 11:19:22,223 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:19:22,235 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:20:57,610 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:22:34,703 - INFO - 
Evaluating fold performance...
2026-01-06 11:22:40,447 - INFO - 
Fold 5 Results:
2026-01-06 11:22:40,447 - INFO -   • Accuracy:  0.7017
2026-01-06 11:22:40,451 - INFO -   • Precision: 0.7273
2026-01-06 11:22:40,451 - INFO -   • Recall:    0.7017
2026-01-06 11:22:40,452 - INFO -   • F1-Score:  0.6522
2026-01-06 11:22:40,453 - INFO -   • Kappa:     0.6022
2026-01-06 11:22:41,058 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_5.keras
2026-01-06 11:22:41,478 - INFO - 
============================================================
2026-01-06 11:22:41,479 - INFO - K-Fold Cross-Validation Summary
2026-01-06 11:22:41,481 - INFO - ============================================================
2026-01-06 11:22:41,482 - INFO - Average Accuracy:  0.7372 ± 0.0252
2026-01-06 11:22:41,483 - INFO - Average Precision: 0.7487
2026-01-06 11:22:41,484 - INFO - Average Recall:    0.7372
2026-01-06 11:22:41,484 - INFO - Average F1-Score:  0.7118 ± 0.0394
2026-01-06 11:22:41,485 - INFO - Average Kappa:     0.6496
2026-01-06 11:22:41,487 - INFO - Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 11:22:41,488 - INFO - Generating K-Fold visualization plots...
2026-01-06 11:22:42,810 - INFO - K-fold analysis plot saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 11:22:42,819 - INFO - 
================================================================================
2026-01-06 11:22:42,819 - INFO - Evaluating on Test Set
2026-01-06 11:22:42,820 - INFO - ================================================================================

2026-01-06 11:22:42,979 - INFO - 
============================================================
2026-01-06 11:22:42,980 - INFO - Making Ensemble Predictions
2026-01-06 11:22:42,981 - INFO - ============================================================
2026-01-06 11:22:42,982 - INFO - Combining predictions from 5 models...
2026-01-06 11:22:42,982 - INFO - Loading model 1/5: model_fold_1.keras
2026-01-06 11:22:49,627 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:22:50,036 - INFO - Loading model 2/5: model_fold_2.keras
2026-01-06 11:22:56,087 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:22:56,250 - INFO - Loading model 3/5: model_fold_3.keras
2026-01-06 11:23:02,335 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:23:02,504 - INFO - Loading model 4/5: model_fold_4.keras
2026-01-06 11:23:08,541 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:23:08,703 - INFO - Loading model 5/5: model_fold_5.keras
2026-01-06 11:23:14,791 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:23:14,953 - INFO - Ensemble prediction shape: (1183, 4)
2026-01-06 11:23:14,960 - INFO - 
============================================================
2026-01-06 11:23:14,960 - INFO - ENSEMBLE TEST RESULTS
2026-01-06 11:23:14,962 - INFO - ============================================================
2026-01-06 11:23:14,963 - INFO - Accuracy:          0.5943 (59.43%)
2026-01-06 11:23:14,963 - INFO - Precision (Macro): 0.5785
2026-01-06 11:23:14,964 - INFO - Recall (Macro):    0.6913
2026-01-06 11:23:14,965 - INFO - F1-Score (Macro):  0.5718
2026-01-06 11:23:14,965 - INFO - Cohen's Kappa:     0.2971
2026-01-06 11:23:14,966 - INFO - MCC:               0.3244
2026-01-06 11:23:14,981 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.26      0.71      0.38        83
 Moderate Impairment       0.71      1.00      0.83        12
       No Impairment       0.67      0.83      0.74       640
Very Mild Impairment       0.68      0.22      0.34       448

            accuracy                           0.59      1183
           macro avg       0.58      0.69      0.57      1183
        weighted avg       0.65      0.59      0.56      1183

2026-01-06 11:23:14,982 - INFO - Metrics saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 11:23:15,788 - INFO - Confusion matrix saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2026-01-06 11:23:15,789 - INFO - 
================================================================================
2026-01-06 11:23:15,792 - INFO - Generating Grad-CAM++ Visualizations
2026-01-06 11:23:15,792 - INFO - ================================================================================

2026-01-06 11:23:17,943 - INFO - Processing 3 images for class: Mild Impairment
2026-01-06 11:23:22,320 - INFO - Processing 3 images for class: Moderate Impairment
2026-01-06 11:23:25,459 - INFO - Processing 3 images for class: No Impairment
2026-01-06 11:23:28,405 - INFO - Processing 3 images for class: Very Mild Impairment
2026-01-06 11:23:31,343 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus
2026-01-06 11:23:31,580 - INFO - 
================================================================================
2026-01-06 11:23:31,580 - INFO - Starting SHAP Analysis
2026-01-06 11:23:31,584 - INFO - ================================================================================

2026-01-06 11:23:31,585 - INFO - 
============================================================
2026-01-06 11:23:31,586 - INFO - Starting SHAP Analysis
2026-01-06 11:23:31,587 - INFO - ============================================================
2026-01-06 11:23:31,588 - INFO - Loading model from: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 11:23:35,280 - INFO - Created logits model (softmax replaced with linear activation)
2026-01-06 11:23:35,281 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test
2026-01-06 11:23:35,288 - INFO - Found 1183 images from 4 classes
2026-01-06 11:23:35,288 - INFO -   • Mild Impairment: 83 images
2026-01-06 11:23:35,289 - INFO -   • Moderate Impairment: 12 images
2026-01-06 11:23:35,290 - INFO -   • No Impairment: 640 images
2026-01-06 11:23:35,290 - INFO -   • Very Mild Impairment: 448 images
2026-01-06 11:23:35,292 - INFO - Loading 50 background samples...
2026-01-06 11:23:35,374 - INFO - Loaded 50 background samples
2026-01-06 11:23:35,375 - INFO - Loading 10 test samples...
2026-01-06 11:23:35,392 - INFO - Loaded 10 test samples
2026-01-06 11:23:35,392 - INFO - Creating SHAP GradientExplainer...
2026-01-06 11:23:35,393 - INFO - Calculating SHAP values...
2026-01-06 11:24:46,150 - INFO - SHAP Values Type: <class 'numpy.ndarray'>
2026-01-06 11:24:46,162 - INFO - SHAP Values Shape: (10, 224, 224, 3, 4)
2026-01-06 11:24:46,162 - INFO - Test Samples Display Shape: (10, 224, 224, 3)
2026-01-06 11:24:46,163 - INFO - Generating SHAP visualization for: Mild Impairment
2026-01-06 11:24:46,185 - INFO - Total absolute attribution for Mild Impairment: 1.1693e+04
2026-01-06 11:24:46,237 - INFO - Boosting SHAP values by factor: 24.35 (Max val: 4.1061e-02)
2026-01-06 11:24:46,719 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.7339159830747284..2.198715677872861].
2026-01-06 11:24:46,765 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.4931669245171424..2.7647509460202286].
2026-01-06 11:24:46,812 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.238865436389988..1.9302642530104723].
2026-01-06 11:24:46,858 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.9257358529228505..2.306796045692858].
2026-01-06 11:24:46,905 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0032663204172998..1.574360979138086].
2026-01-06 11:24:46,951 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0855036618604834..1.0973663807913727].
2026-01-06 11:24:46,997 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.845341883815414..1.7857729664537518].
2026-01-06 11:24:47,043 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.8848785996295732..0.9245166050485913].
2026-01-06 11:24:47,095 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.7041998904566205..1.9021889617743344].
2026-01-06 11:24:47,146 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0819001459954318..1.4137128253990554].
2026-01-06 11:24:48,598 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Mild_Impairment.png
2026-01-06 11:24:48,599 - INFO - Generating SHAP visualization for: Moderate Impairment
2026-01-06 11:24:48,642 - INFO - Total absolute attribution for Moderate Impairment: 1.1693e+04
2026-01-06 11:24:48,697 - INFO - Boosting SHAP values by factor: 24.35 (Max val: 4.1061e-02)
2026-01-06 11:24:49,163 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.7339159830747284..2.198715677872861].
2026-01-06 11:24:49,234 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.4931669245171424..2.7647509460202286].
2026-01-06 11:24:49,283 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.238865436389988..1.9302642530104723].
2026-01-06 11:24:49,333 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.9257358529228505..2.306796045692858].
2026-01-06 11:24:49,385 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0032663204172998..1.574360979138086].
2026-01-06 11:24:49,435 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0855036618604834..1.0973663807913727].
2026-01-06 11:24:49,486 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.845341883815414..1.7857729664537518].
2026-01-06 11:24:49,536 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.8848785996295732..0.9245166050485913].
2026-01-06 11:24:49,587 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.7041998904566205..1.9021889617743344].
2026-01-06 11:24:49,638 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0819001459954318..1.4137128253990554].
2026-01-06 11:24:51,084 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Moderate_Impairment.png
2026-01-06 11:24:51,084 - INFO - Generating SHAP visualization for: No Impairment
2026-01-06 11:24:51,114 - INFO - Total absolute attribution for No Impairment: 1.1693e+04
2026-01-06 11:24:51,166 - INFO - Boosting SHAP values by factor: 24.35 (Max val: 4.1061e-02)
2026-01-06 11:24:51,845 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.7339159830747284..2.198715677872861].
2026-01-06 11:24:51,892 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.4931669245171424..2.7647509460202286].
2026-01-06 11:24:51,941 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.238865436389988..1.9302642530104723].
2026-01-06 11:24:51,987 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.9257358529228505..2.306796045692858].
2026-01-06 11:24:52,032 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0032663204172998..1.574360979138086].
2026-01-06 11:24:52,083 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0855036618604834..1.0973663807913727].
2026-01-06 11:24:52,130 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.845341883815414..1.7857729664537518].
2026-01-06 11:24:52,177 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.8848785996295732..0.9245166050485913].
2026-01-06 11:24:52,224 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.7041998904566205..1.9021889617743344].
2026-01-06 11:24:52,270 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0819001459954318..1.4137128253990554].
2026-01-06 11:24:53,709 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_No_Impairment.png
2026-01-06 11:24:53,710 - INFO - Generating SHAP visualization for: Very Mild Impairment
2026-01-06 11:24:53,739 - INFO - Total absolute attribution for Very Mild Impairment: 1.1693e+04
2026-01-06 11:24:53,792 - INFO - Boosting SHAP values by factor: 24.35 (Max val: 4.1061e-02)
2026-01-06 11:24:54,274 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.7339159830747284..2.198715677872861].
2026-01-06 11:24:54,322 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.4931669245171424..2.7647509460202286].
2026-01-06 11:24:54,371 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.238865436389988..1.9302642530104723].
2026-01-06 11:24:54,418 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.9257358529228505..2.306796045692858].
2026-01-06 11:24:54,465 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0032663204172998..1.574360979138086].
2026-01-06 11:24:54,513 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0855036618604834..1.0973663807913727].
2026-01-06 11:24:54,561 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.845341883815414..1.7857729664537518].
2026-01-06 11:24:54,609 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.8848785996295732..0.9245166050485913].
2026-01-06 11:24:54,658 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.7041998904566205..1.9021889617743344].
2026-01-06 11:24:54,707 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.0819001459954318..1.4137128253990554].
2026-01-06 11:24:56,136 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Very_Mild_Impairment.png
2026-01-06 11:24:57,078 - INFO - SHAP analysis complete. Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis
2026-01-06 11:24:57,346 - INFO - 
================================================================================
2026-01-06 11:24:57,346 - INFO - ANALYSIS COMPLETE!
2026-01-06 11:24:57,349 - INFO - ================================================================================

2026-01-06 11:24:57,350 - INFO - All results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced

2026-01-06 11:24:57,351 - INFO - Generated Files:
2026-01-06 11:24:57,352 - INFO -   K-Fold Analysis:  C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 11:24:57,353 - INFO -   K-Fold Results:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 11:24:57,354 - INFO -   Ensemble Results: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 11:24:57,356 - INFO -   Grad-CAM++ Viz:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus/
2026-01-06 11:24:57,356 - INFO -   SHAP Analysis:    C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis/
2026-01-06 11:24:57,357 - INFO -   Trained Models:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models/
2026-01-06 11:24:57,358 - INFO - 
================================================================================

2026-01-06 11:30:03,494 - INFO - ================================================================================
2026-01-06 11:30:03,494 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-06 11:30:03,495 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-06 11:30:03,495 - INFO - ================================================================================
2026-01-06 11:30:03,496 - INFO - Configuration:
2026-01-06 11:30:03,497 - INFO -   • Image Size: 224x224
2026-01-06 11:30:03,498 - INFO -   • Batch Size: 32
2026-01-06 11:30:03,499 - INFO -   • K-Folds: 5
2026-01-06 11:30:03,499 - INFO -   • Epochs: 2
2026-01-06 11:30:03,620 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-06 11:30:03,621 - INFO - Random seeds set (Strict determinism disabled for GPU compatibility)
2026-01-06 11:30:03,624 - INFO - Starting K-Fold Cross-Validation...
2026-01-06 11:30:03,625 - INFO - 
================================================================================
2026-01-06 11:30:03,626 - INFO - Starting 5-Fold Cross-Validation
2026-01-06 11:30:03,626 - INFO - ================================================================================

2026-01-06 11:30:03,627 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-06 11:30:03,676 - INFO - Found 10240 images from 4 classes
2026-01-06 11:30:03,676 - INFO -   • Mild Impairment: 2560 images
2026-01-06 11:30:03,679 - INFO -   • Moderate Impairment: 2560 images
2026-01-06 11:30:03,682 - INFO -   • No Impairment: 2560 images
2026-01-06 11:30:03,683 - INFO -   • Very Mild Impairment: 2560 images
2026-01-06 11:30:03,689 - INFO - 
============================================================
2026-01-06 11:30:03,689 - INFO - Training Fold 1/5
2026-01-06 11:30:03,690 - INFO - ============================================================
2026-01-06 11:30:03,814 - INFO - Training samples: 8192
2026-01-06 11:30:03,815 - INFO - Validation samples: 2048
2026-01-06 11:30:03,819 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:30:03,820 - INFO - Building model architecture...
2026-01-06 11:30:06,728 - INFO - Model created with 188 layers
2026-01-06 11:30:06,732 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:30:06,742 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:31:38,409 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:33:09,368 - INFO - 
Evaluating fold performance...
2026-01-06 11:33:15,033 - INFO - 
Fold 1 Results:
2026-01-06 11:33:15,034 - INFO -   • Accuracy:  0.7295
2026-01-06 11:33:15,037 - INFO -   • Precision: 0.7496
2026-01-06 11:33:15,038 - INFO -   • Recall:    0.7295
2026-01-06 11:33:15,039 - INFO -   • F1-Score:  0.7029
2026-01-06 11:33:15,040 - INFO -   • Kappa:     0.6393
2026-01-06 11:33:15,669 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 11:33:15,904 - INFO - 
============================================================
2026-01-06 11:33:15,904 - INFO - Training Fold 2/5
2026-01-06 11:33:15,906 - INFO - ============================================================
2026-01-06 11:33:16,078 - INFO - Training samples: 8192
2026-01-06 11:33:16,078 - INFO - Validation samples: 2048
2026-01-06 11:33:16,083 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:33:16,083 - INFO - Building model architecture...
2026-01-06 11:33:17,447 - INFO - Model created with 188 layers
2026-01-06 11:33:17,451 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:33:17,461 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:34:49,073 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:36:21,199 - INFO - 
Evaluating fold performance...
2026-01-06 11:36:26,849 - INFO - 
Fold 2 Results:
2026-01-06 11:36:26,849 - INFO -   • Accuracy:  0.7759
2026-01-06 11:36:26,850 - INFO -   • Precision: 0.7797
2026-01-06 11:36:26,852 - INFO -   • Recall:    0.7759
2026-01-06 11:36:26,853 - INFO -   • F1-Score:  0.7765
2026-01-06 11:36:26,854 - INFO -   • Kappa:     0.7012
2026-01-06 11:36:27,475 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-06 11:36:27,903 - INFO - 
============================================================
2026-01-06 11:36:27,903 - INFO - Training Fold 3/5
2026-01-06 11:36:27,906 - INFO - ============================================================
2026-01-06 11:36:28,084 - INFO - Training samples: 8192
2026-01-06 11:36:28,085 - INFO - Validation samples: 2048
2026-01-06 11:36:28,090 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:36:28,090 - INFO - Building model architecture...
2026-01-06 11:36:29,511 - INFO - Model created with 188 layers
2026-01-06 11:36:29,514 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:36:29,523 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:38:05,908 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:39:42,315 - INFO - 
Evaluating fold performance...
2026-01-06 11:39:48,086 - INFO - 
Fold 3 Results:
2026-01-06 11:39:48,086 - INFO -   • Accuracy:  0.7266
2026-01-06 11:39:48,090 - INFO -   • Precision: 0.7392
2026-01-06 11:39:48,091 - INFO -   • Recall:    0.7266
2026-01-06 11:39:48,091 - INFO -   • F1-Score:  0.6965
2026-01-06 11:39:48,092 - INFO -   • Kappa:     0.6354
2026-01-06 11:39:48,732 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_3.keras
2026-01-06 11:39:49,162 - INFO - 
============================================================
2026-01-06 11:39:49,163 - INFO - Training Fold 4/5
2026-01-06 11:39:49,166 - INFO - ============================================================
2026-01-06 11:39:49,349 - INFO - Training samples: 8192
2026-01-06 11:39:49,349 - INFO - Validation samples: 2048
2026-01-06 11:39:49,353 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:39:49,354 - INFO - Building model architecture...
2026-01-06 11:39:50,769 - INFO - Model created with 188 layers
2026-01-06 11:39:50,772 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:39:50,783 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:41:26,344 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:43:03,232 - INFO - 
Evaluating fold performance...
2026-01-06 11:43:08,981 - INFO - 
Fold 4 Results:
2026-01-06 11:43:08,981 - INFO -   • Accuracy:  0.6733
2026-01-06 11:43:08,984 - INFO -   • Precision: 0.7413
2026-01-06 11:43:08,985 - INFO -   • Recall:    0.6733
2026-01-06 11:43:08,986 - INFO -   • F1-Score:  0.6236
2026-01-06 11:43:08,987 - INFO -   • Kappa:     0.5645
2026-01-06 11:43:09,657 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_4.keras
2026-01-06 11:43:10,093 - INFO - 
============================================================
2026-01-06 11:43:10,093 - INFO - Training Fold 5/5
2026-01-06 11:43:10,095 - INFO - ============================================================
2026-01-06 11:43:10,276 - INFO - Training samples: 8192
2026-01-06 11:43:10,276 - INFO - Validation samples: 2048
2026-01-06 11:43:10,280 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:43:10,281 - INFO - Building model architecture...
2026-01-06 11:43:11,695 - INFO - Model created with 188 layers
2026-01-06 11:43:11,698 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:43:11,709 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:44:47,721 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 11:46:27,336 - INFO - 
Evaluating fold performance...
2026-01-06 11:46:33,050 - INFO - 
Fold 5 Results:
2026-01-06 11:46:33,050 - INFO -   • Accuracy:  0.6929
2026-01-06 11:46:33,051 - INFO -   • Precision: 0.7234
2026-01-06 11:46:33,051 - INFO -   • Recall:    0.6929
2026-01-06 11:46:33,051 - INFO -   • F1-Score:  0.6425
2026-01-06 11:46:33,052 - INFO -   • Kappa:     0.5905
2026-01-06 11:46:33,698 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_5.keras
2026-01-06 11:46:34,132 - INFO - 
============================================================
2026-01-06 11:46:34,133 - INFO - K-Fold Cross-Validation Summary
2026-01-06 11:46:34,136 - INFO - ============================================================
2026-01-06 11:46:34,137 - INFO - Average Accuracy:  0.7196 ± 0.0351
2026-01-06 11:46:34,137 - INFO - Average Precision: 0.7466
2026-01-06 11:46:34,138 - INFO - Average Recall:    0.7196
2026-01-06 11:46:34,140 - INFO - Average F1-Score:  0.6884 ± 0.0536
2026-01-06 11:46:34,141 - INFO - Average Kappa:     0.6262
2026-01-06 11:46:34,143 - INFO - Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 11:46:34,143 - INFO - Generating K-Fold visualization plots...
2026-01-06 11:46:35,460 - INFO - K-fold analysis plot saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 11:46:35,472 - INFO - 
================================================================================
2026-01-06 11:46:35,472 - INFO - Evaluating on Test Set
2026-01-06 11:46:35,472 - INFO - ================================================================================

2026-01-06 11:46:35,601 - INFO - 
============================================================
2026-01-06 11:46:35,602 - INFO - Making Ensemble Predictions
2026-01-06 11:46:35,603 - INFO - ============================================================
2026-01-06 11:46:35,604 - INFO - Combining predictions from 5 models...
2026-01-06 11:46:35,605 - INFO - Loading model 1/5: model_fold_1.keras
2026-01-06 11:46:42,120 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:46:42,543 - INFO - Loading model 2/5: model_fold_2.keras
2026-01-06 11:46:48,632 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:46:48,795 - INFO - Loading model 3/5: model_fold_3.keras
2026-01-06 11:46:54,799 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:46:54,959 - INFO - Loading model 4/5: model_fold_4.keras
2026-01-06 11:47:01,007 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:47:01,177 - INFO - Loading model 5/5: model_fold_5.keras
2026-01-06 11:47:07,256 - INFO -   Predictions shape: (1183, 4)
2026-01-06 11:47:07,427 - INFO - Ensemble prediction shape: (1183, 4)
2026-01-06 11:47:07,434 - INFO - 
============================================================
2026-01-06 11:47:07,435 - INFO - ENSEMBLE TEST RESULTS
2026-01-06 11:47:07,435 - INFO - ============================================================
2026-01-06 11:47:07,436 - INFO - Accuracy:          0.5232 (52.32%)
2026-01-06 11:47:07,437 - INFO - Precision (Macro): 0.6326
2026-01-06 11:47:07,438 - INFO - Recall (Macro):    0.5352
2026-01-06 11:47:07,439 - INFO - F1-Score (Macro):  0.4653
2026-01-06 11:47:07,439 - INFO - Cohen's Kappa:     0.2184
2026-01-06 11:47:07,440 - INFO - MCC:               0.2521
2026-01-06 11:47:07,451 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.18      0.75      0.29        83
 Moderate Impairment       1.00      0.50      0.67        12
       No Impairment       0.66      0.78      0.72       640
Very Mild Impairment       0.69      0.11      0.19       448

            accuracy                           0.52      1183
           macro avg       0.63      0.54      0.47      1183
        weighted avg       0.64      0.52      0.49      1183

2026-01-06 11:47:07,452 - INFO - Metrics saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 11:47:08,276 - INFO - Confusion matrix saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2026-01-06 11:47:08,276 - INFO - 
================================================================================
2026-01-06 11:47:08,280 - INFO - Generating Grad-CAM++ Visualizations
2026-01-06 11:47:08,280 - INFO - ================================================================================

2026-01-06 11:47:10,447 - INFO - Processing 3 images for class: Mild Impairment
2026-01-06 11:47:14,868 - INFO - Processing 3 images for class: Moderate Impairment
2026-01-06 11:47:18,061 - INFO - Processing 3 images for class: No Impairment
2026-01-06 11:47:21,064 - INFO - Processing 3 images for class: Very Mild Impairment
2026-01-06 11:47:23,997 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus
2026-01-06 11:47:24,240 - INFO - 
================================================================================
2026-01-06 11:47:24,241 - INFO - Starting SHAP Analysis
2026-01-06 11:47:24,243 - INFO - ================================================================================

2026-01-06 11:47:24,245 - INFO - 
============================================================
2026-01-06 11:47:24,246 - INFO - Starting SHAP Analysis
2026-01-06 11:47:24,246 - INFO - ============================================================
2026-01-06 11:47:24,247 - INFO - Loading model from: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 11:47:28,103 - INFO - Created logits model (softmax replaced with linear activation)
2026-01-06 11:47:28,104 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test
2026-01-06 11:47:28,112 - INFO - Found 1183 images from 4 classes
2026-01-06 11:47:28,112 - INFO -   • Mild Impairment: 83 images
2026-01-06 11:47:28,112 - INFO -   • Moderate Impairment: 12 images
2026-01-06 11:47:28,113 - INFO -   • No Impairment: 640 images
2026-01-06 11:47:28,113 - INFO -   • Very Mild Impairment: 448 images
2026-01-06 11:47:28,114 - INFO - Loading 50 background samples...
2026-01-06 11:47:28,196 - INFO - Loaded 50 background samples
2026-01-06 11:47:28,196 - INFO - Loading 10 test samples...
2026-01-06 11:47:28,213 - INFO - Loaded 10 test samples
2026-01-06 11:47:28,214 - INFO - Creating SHAP GradientExplainer...
2026-01-06 11:47:28,215 - INFO - Calculating SHAP values...
2026-01-06 11:48:30,743 - INFO - SHAP Values Type: <class 'numpy.ndarray'>
2026-01-06 11:48:30,755 - INFO - SHAP Values Shape: (10, 224, 224, 3, 4)
2026-01-06 11:48:30,756 - INFO - Test Samples Display Shape: (10, 224, 224, 3)
2026-01-06 11:48:30,757 - INFO - Generating SHAP visualization for: Mild Impairment
2026-01-06 11:48:30,783 - INFO - Total absolute attribution for Mild Impairment: 9.3423e+03
2026-01-06 11:48:30,854 - INFO - Boosting SHAP values by factor: 27.28 (Max val: 3.6652e-02)
2026-01-06 11:48:31,330 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6114693751292735..0.6950566667743369].
2026-01-06 11:48:31,378 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.8750967217174581..0.8112960277652986].
2026-01-06 11:48:31,424 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.3764622931521528..0.8559941790571464].
2026-01-06 11:48:31,472 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.8607637528163636..0.8969325750413304].
2026-01-06 11:48:31,521 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6811353762970547..1.1114167911286494].
2026-01-06 11:48:31,570 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6730845767142506..0.7439081264038734].
2026-01-06 11:48:31,617 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6276547262826762..0.8968584154004389].
2026-01-06 11:48:31,664 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6209179257644475..0.6611714027695632].
2026-01-06 11:48:31,710 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.7676910070115808..1.8054784964848773].
2026-01-06 11:48:31,760 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.7710122999284263..0.7636400032515966].
2026-01-06 11:48:33,215 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Mild_Impairment.png
2026-01-06 11:48:33,215 - INFO - Generating SHAP visualization for: Moderate Impairment
2026-01-06 11:48:33,245 - INFO - Total absolute attribution for Moderate Impairment: 9.3423e+03
2026-01-06 11:48:33,307 - INFO - Boosting SHAP values by factor: 27.28 (Max val: 3.6652e-02)
2026-01-06 11:48:33,783 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6114693751292735..0.6950566667743369].
2026-01-06 11:48:33,831 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.8750967217174581..0.8112960277652986].
2026-01-06 11:48:33,879 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.3764622931521528..0.8559941790571464].
2026-01-06 11:48:33,928 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.8607637528163636..0.8969325750413304].
2026-01-06 11:48:33,978 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6811353762970547..1.1114167911286494].
2026-01-06 11:48:34,030 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6730845767142506..0.7439081264038734].
2026-01-06 11:48:34,082 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6276547262826762..0.8968584154004389].
2026-01-06 11:48:34,132 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6209179257644475..0.6611714027695632].
2026-01-06 11:48:34,183 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.7676910070115808..1.8054784964848773].
2026-01-06 11:48:34,233 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.7710122999284263..0.7636400032515966].
2026-01-06 11:48:35,673 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Moderate_Impairment.png
2026-01-06 11:48:35,674 - INFO - Generating SHAP visualization for: No Impairment
2026-01-06 11:48:35,703 - INFO - Total absolute attribution for No Impairment: 9.3423e+03
2026-01-06 11:48:35,768 - INFO - Boosting SHAP values by factor: 27.28 (Max val: 3.6652e-02)
2026-01-06 11:48:36,473 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6114693751292735..0.6950566667743369].
2026-01-06 11:48:36,522 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.8750967217174581..0.8112960277652986].
2026-01-06 11:48:36,568 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.3764622931521528..0.8559941790571464].
2026-01-06 11:48:36,615 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.8607637528163636..0.8969325750413304].
2026-01-06 11:48:36,662 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6811353762970547..1.1114167911286494].
2026-01-06 11:48:36,709 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6730845767142506..0.7439081264038734].
2026-01-06 11:48:36,755 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6276547262826762..0.8968584154004389].
2026-01-06 11:48:36,806 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6209179257644475..0.6611714027695632].
2026-01-06 11:48:36,857 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.7676910070115808..1.8054784964848773].
2026-01-06 11:48:36,903 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.7710122999284263..0.7636400032515966].
2026-01-06 11:48:38,369 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_No_Impairment.png
2026-01-06 11:48:38,370 - INFO - Generating SHAP visualization for: Very Mild Impairment
2026-01-06 11:48:38,399 - INFO - Total absolute attribution for Very Mild Impairment: 9.3423e+03
2026-01-06 11:48:38,461 - INFO - Boosting SHAP values by factor: 27.28 (Max val: 3.6652e-02)
2026-01-06 11:48:38,954 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6114693751292735..0.6950566667743369].
2026-01-06 11:48:39,003 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.8750967217174581..0.8112960277652986].
2026-01-06 11:48:39,053 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.3764622931521528..0.8559941790571464].
2026-01-06 11:48:39,101 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-1.8607637528163636..0.8969325750413304].
2026-01-06 11:48:39,150 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6811353762970547..1.1114167911286494].
2026-01-06 11:48:39,199 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6730845767142506..0.7439081264038734].
2026-01-06 11:48:39,247 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6276547262826762..0.8968584154004389].
2026-01-06 11:48:39,293 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.6209179257644475..0.6611714027695632].
2026-01-06 11:48:39,342 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-2.7676910070115808..1.8054784964848773].
2026-01-06 11:48:39,391 - WARNING - Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers). Got range [-0.7710122999284263..0.7636400032515966].
2026-01-06 11:48:40,834 - INFO - Saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis\shap_Very_Mild_Impairment.png
2026-01-06 11:48:41,828 - INFO - SHAP analysis complete. Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis
2026-01-06 11:48:42,124 - INFO - 
================================================================================
2026-01-06 11:48:42,125 - INFO - ANALYSIS COMPLETE!
2026-01-06 11:48:42,128 - INFO - ================================================================================

2026-01-06 11:48:42,129 - INFO - All results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced

2026-01-06 11:48:42,130 - INFO - Generated Files:
2026-01-06 11:48:42,131 - INFO -   K-Fold Analysis:  C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 11:48:42,131 - INFO -   K-Fold Results:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 11:48:42,133 - INFO -   Ensemble Results: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 11:48:42,134 - INFO -   Grad-CAM++ Viz:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus/
2026-01-06 11:48:42,135 - INFO -   SHAP Analysis:    C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis/
2026-01-06 11:48:42,137 - INFO -   Trained Models:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models/
2026-01-06 11:48:42,138 - INFO - 
================================================================================

2026-01-06 11:57:40,084 - INFO - ================================================================================
2026-01-06 11:57:40,084 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-06 11:57:40,086 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-06 11:57:40,088 - INFO - ================================================================================
2026-01-06 11:57:40,089 - INFO - Configuration:
2026-01-06 11:57:40,090 - INFO -   • Image Size: 224x224
2026-01-06 11:57:40,090 - INFO -   • Batch Size: 32
2026-01-06 11:57:40,091 - INFO -   • K-Folds: 5
2026-01-06 11:57:40,092 - INFO -   • Epochs: 2
2026-01-06 11:57:40,192 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-06 11:57:40,192 - INFO - Random seeds set (Strict determinism disabled for GPU compatibility)
2026-01-06 11:57:40,195 - INFO - Starting K-Fold Cross-Validation...
2026-01-06 11:57:40,196 - INFO - 
================================================================================
2026-01-06 11:57:40,197 - INFO - Starting 5-Fold Cross-Validation
2026-01-06 11:57:40,197 - INFO - ================================================================================

2026-01-06 11:57:40,198 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-06 11:57:40,249 - INFO - Found 10240 images from 4 classes
2026-01-06 11:57:40,250 - INFO -   • Mild Impairment: 2560 images
2026-01-06 11:57:40,252 - INFO -   • Moderate Impairment: 2560 images
2026-01-06 11:57:40,253 - INFO -   • No Impairment: 2560 images
2026-01-06 11:57:40,254 - INFO -   • Very Mild Impairment: 2560 images
2026-01-06 11:57:40,260 - INFO - 
============================================================
2026-01-06 11:57:40,261 - INFO - Training Fold 1/5
2026-01-06 11:57:40,261 - INFO - ============================================================
2026-01-06 11:57:40,388 - INFO - Training samples: 8192
2026-01-06 11:57:40,389 - INFO - Validation samples: 2048
2026-01-06 11:57:40,393 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 11:57:40,394 - INFO - Building model architecture...
2026-01-06 11:57:43,209 - INFO - Model created with 188 layers
2026-01-06 11:57:43,212 - INFO - Trainable parameters: 25,305,860
2026-01-06 11:57:43,220 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 11:59:16,114 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 12:00:45,890 - INFO - 
Evaluating fold performance...
2026-01-06 12:00:51,431 - INFO - 
Fold 1 Results:
2026-01-06 12:00:51,432 - INFO -   • Accuracy:  0.7378
2026-01-06 12:00:51,435 - INFO -   • Precision: 0.7370
2026-01-06 12:00:51,436 - INFO -   • Recall:    0.7378
2026-01-06 12:00:51,437 - INFO -   • F1-Score:  0.7270
2026-01-06 12:00:51,437 - INFO -   • Kappa:     0.6504
2026-01-06 12:00:52,071 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 12:00:52,301 - INFO - 
============================================================
2026-01-06 12:00:52,301 - INFO - Training Fold 2/5
2026-01-06 12:00:52,304 - INFO - ============================================================
2026-01-06 12:00:52,474 - INFO - Training samples: 8192
2026-01-06 12:00:52,475 - INFO - Validation samples: 2048
2026-01-06 12:00:52,479 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 12:00:52,480 - INFO - Building model architecture...
2026-01-06 12:00:53,850 - INFO - Model created with 188 layers
2026-01-06 12:00:53,853 - INFO - Trainable parameters: 25,305,860
2026-01-06 12:00:53,862 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 12:02:25,012 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 12:03:57,312 - INFO - 
Evaluating fold performance...
2026-01-06 12:04:02,816 - INFO - 
Fold 2 Results:
2026-01-06 12:04:02,816 - INFO -   • Accuracy:  0.7285
2026-01-06 12:04:02,819 - INFO -   • Precision: 0.7406
2026-01-06 12:04:02,820 - INFO -   • Recall:    0.7285
2026-01-06 12:04:02,821 - INFO -   • F1-Score:  0.7141
2026-01-06 12:04:02,821 - INFO -   • Kappa:     0.6380
2026-01-06 12:04:03,431 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-06 12:04:03,844 - INFO - 
============================================================
2026-01-06 12:04:03,845 - INFO - Training Fold 3/5
2026-01-06 12:04:03,847 - INFO - ============================================================
2026-01-06 12:04:04,026 - INFO - Training samples: 8192
2026-01-06 12:04:04,027 - INFO - Validation samples: 2048
2026-01-06 12:04:04,031 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 12:04:04,031 - INFO - Building model architecture...
2026-01-06 12:04:05,391 - INFO - Model created with 188 layers
2026-01-06 12:04:05,394 - INFO - Trainable parameters: 25,305,860
2026-01-06 12:04:05,403 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 12:05:37,861 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 12:07:12,222 - INFO - 
Evaluating fold performance...
2026-01-06 12:07:17,728 - INFO - 
Fold 3 Results:
2026-01-06 12:07:17,729 - INFO -   • Accuracy:  0.7393
2026-01-06 12:07:17,732 - INFO -   • Precision: 0.7365
2026-01-06 12:07:17,733 - INFO -   • Recall:    0.7393
2026-01-06 12:07:17,734 - INFO -   • F1-Score:  0.7291
2026-01-06 12:07:17,734 - INFO -   • Kappa:     0.6523
2026-01-06 12:07:18,372 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_3.keras
2026-01-06 12:07:18,784 - INFO - 
============================================================
2026-01-06 12:07:18,785 - INFO - Training Fold 4/5
2026-01-06 12:07:18,788 - INFO - ============================================================
2026-01-06 12:07:18,966 - INFO - Training samples: 8192
2026-01-06 12:07:18,966 - INFO - Validation samples: 2048
2026-01-06 12:07:18,970 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 12:07:18,971 - INFO - Building model architecture...
2026-01-06 12:07:20,342 - INFO - Model created with 188 layers
2026-01-06 12:07:20,345 - INFO - Trainable parameters: 25,305,860
2026-01-06 12:07:20,356 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 12:08:52,945 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 12:10:28,454 - INFO - 
Evaluating fold performance...
2026-01-06 12:10:33,910 - INFO - 
Fold 4 Results:
2026-01-06 12:10:33,911 - INFO -   • Accuracy:  0.7764
2026-01-06 12:10:33,914 - INFO -   • Precision: 0.7761
2026-01-06 12:10:33,915 - INFO -   • Recall:    0.7764
2026-01-06 12:10:33,916 - INFO -   • F1-Score:  0.7739
2026-01-06 12:10:33,916 - INFO -   • Kappa:     0.7018
2026-01-06 12:10:34,523 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_4.keras
2026-01-06 12:10:34,930 - INFO - 
============================================================
2026-01-06 12:10:34,931 - INFO - Training Fold 5/5
2026-01-06 12:10:34,934 - INFO - ============================================================
2026-01-06 12:10:35,114 - INFO - Training samples: 8192
2026-01-06 12:10:35,114 - INFO - Validation samples: 2048
2026-01-06 12:10:35,118 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 12:10:35,118 - INFO - Building model architecture...
2026-01-06 12:10:36,487 - INFO - Model created with 188 layers
2026-01-06 12:10:36,490 - INFO - Trainable parameters: 25,305,860
2026-01-06 12:10:36,500 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 12:12:11,963 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 12:13:49,588 - INFO - 
Evaluating fold performance...
2026-01-06 12:13:55,118 - INFO - 
Fold 5 Results:
2026-01-06 12:13:55,118 - INFO -   • Accuracy:  0.6768
2026-01-06 12:13:55,121 - INFO -   • Precision: 0.6464
2026-01-06 12:13:55,122 - INFO -   • Recall:    0.6768
2026-01-06 12:13:55,123 - INFO -   • F1-Score:  0.6353
2026-01-06 12:13:55,124 - INFO -   • Kappa:     0.5690
2026-01-06 12:13:55,749 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_5.keras
2026-01-06 12:13:56,160 - INFO - 
============================================================
2026-01-06 12:13:56,160 - INFO - K-Fold Cross-Validation Summary
2026-01-06 12:13:56,163 - INFO - ============================================================
2026-01-06 12:13:56,164 - INFO - Average Accuracy:  0.7317 ± 0.0320
2026-01-06 12:13:56,165 - INFO - Average Precision: 0.7273
2026-01-06 12:13:56,165 - INFO - Average Recall:    0.7317
2026-01-06 12:13:56,166 - INFO - Average F1-Score:  0.7159 ± 0.0451
2026-01-06 12:13:56,167 - INFO - Average Kappa:     0.6423
2026-01-06 12:13:56,169 - INFO - Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 12:13:56,169 - INFO - Generating K-Fold visualization plots...
2026-01-06 12:13:57,506 - INFO - K-fold analysis plot saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 12:13:57,514 - INFO - 
================================================================================
2026-01-06 12:13:57,515 - INFO - Evaluating on Test Set
2026-01-06 12:13:57,516 - INFO - ================================================================================

2026-01-06 12:13:57,660 - INFO - 
============================================================
2026-01-06 12:13:57,660 - INFO - Making Ensemble Predictions
2026-01-06 12:13:57,661 - INFO - ============================================================
2026-01-06 12:13:57,662 - INFO - Combining predictions from 5 models...
2026-01-06 12:13:57,663 - INFO - Loading model 1/5: model_fold_1.keras
2026-01-06 12:14:04,204 - INFO -   Predictions shape: (1183, 4)
2026-01-06 12:14:04,622 - INFO - Loading model 2/5: model_fold_2.keras
2026-01-06 12:14:10,518 - INFO -   Predictions shape: (1183, 4)
2026-01-06 12:14:10,687 - INFO - Loading model 3/5: model_fold_3.keras
2026-01-06 12:14:16,561 - INFO -   Predictions shape: (1183, 4)
2026-01-06 12:14:16,722 - INFO - Loading model 4/5: model_fold_4.keras
2026-01-06 12:14:22,708 - INFO -   Predictions shape: (1183, 4)
2026-01-06 12:14:22,874 - INFO - Loading model 5/5: model_fold_5.keras
2026-01-06 12:14:28,805 - INFO -   Predictions shape: (1183, 4)
2026-01-06 12:14:28,971 - INFO - Ensemble prediction shape: (1183, 4)
2026-01-06 12:14:28,978 - INFO - 
============================================================
2026-01-06 12:14:28,979 - INFO - ENSEMBLE TEST RESULTS
2026-01-06 12:14:28,979 - INFO - ============================================================
2026-01-06 12:14:28,980 - INFO - Accuracy:          0.6112 (61.12%)
2026-01-06 12:14:28,981 - INFO - Precision (Macro): 0.5806
2026-01-06 12:14:28,982 - INFO - Recall (Macro):    0.7109
2026-01-06 12:14:28,983 - INFO - F1-Score (Macro):  0.6028
2026-01-06 12:14:28,984 - INFO - Cohen's Kappa:     0.3499
2026-01-06 12:14:28,989 - INFO - MCC:               0.3627
2026-01-06 12:14:28,999 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.25      0.71      0.37        83
 Moderate Impairment       0.71      1.00      0.83        12
       No Impairment       0.73      0.75      0.74       640
Very Mild Impairment       0.64      0.38      0.48       448

            accuracy                           0.61      1183
           macro avg       0.58      0.71      0.60      1183
        weighted avg       0.66      0.61      0.62      1183

2026-01-06 12:14:29,001 - INFO - Metrics saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 12:14:29,787 - INFO - Confusion matrix saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2026-01-06 12:14:29,788 - INFO - 
================================================================================
2026-01-06 12:14:29,791 - INFO - Generating Grad-CAM++ Visualizations
2026-01-06 12:14:29,791 - INFO - ================================================================================

2026-01-06 12:14:31,933 - INFO - Processing 3 images for class: Mild Impairment
2026-01-06 12:14:36,318 - INFO - Processing 3 images for class: Moderate Impairment
2026-01-06 12:14:39,372 - INFO - Processing 3 images for class: No Impairment
2026-01-06 12:14:42,262 - INFO - Processing 3 images for class: Very Mild Impairment
2026-01-06 12:14:45,148 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus
2026-01-06 12:14:45,387 - INFO - 
================================================================================
2026-01-06 12:14:45,388 - INFO - Starting SHAP Analysis
2026-01-06 12:14:45,391 - INFO - ================================================================================

2026-01-06 12:14:45,392 - INFO - 
============================================================
2026-01-06 12:14:45,393 - INFO - Starting SHAP Analysis
2026-01-06 12:14:45,394 - INFO - ============================================================
2026-01-06 12:14:45,394 - INFO - Loading model from: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 12:14:49,142 - INFO - Created logits model (softmax replaced with linear activation)
2026-01-06 12:14:49,143 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test
2026-01-06 12:14:49,150 - INFO - Found 1183 images from 4 classes
2026-01-06 12:14:49,151 - INFO -   • Mild Impairment: 83 images
2026-01-06 12:14:49,152 - INFO -   • Moderate Impairment: 12 images
2026-01-06 12:14:49,152 - INFO -   • No Impairment: 640 images
2026-01-06 12:14:49,153 - INFO -   • Very Mild Impairment: 448 images
2026-01-06 12:14:49,154 - INFO - Loading 50 background samples...
2026-01-06 12:14:49,236 - INFO - Loaded 50 background samples
2026-01-06 12:14:49,237 - INFO - Loading 10 test samples...
2026-01-06 12:14:49,253 - INFO - Loaded 10 test samples
2026-01-06 12:14:49,253 - INFO - Creating SHAP GradientExplainer...
2026-01-06 12:14:49,256 - INFO - Calculating SHAP values...
2026-01-06 12:15:52,710 - INFO - SHAP Values Type: <class 'numpy.ndarray'>
2026-01-06 12:15:52,723 - INFO - SHAP Values Shape: (10, 224, 224, 3, 4)
2026-01-06 12:15:52,723 - INFO - Test Samples Display Shape: (10, 224, 224, 3)
2026-01-06 12:15:52,724 - INFO - Generating SHAP visualization for: Mild Impairment
2026-01-06 12:15:52,746 - INFO - Total absolute attribution for Mild Impairment: 5.7010e+03
2026-01-06 12:15:52,814 - INFO - Boosting SHAP values by factor: 48.92 (Max val: 2.0440e-02)
2026-01-06 12:15:53,227 - WARNING - Error creating SHAP plot for Mild Impairment: Invalid shape (224, 224, 3, 4) for image data
2026-01-06 12:15:53,230 - INFO - Generating SHAP visualization for: Moderate Impairment
2026-01-06 12:15:53,262 - INFO - Total absolute attribution for Moderate Impairment: 5.7010e+03
2026-01-06 12:15:53,326 - INFO - Boosting SHAP values by factor: 48.92 (Max val: 2.0440e-02)
2026-01-06 12:15:53,716 - WARNING - Error creating SHAP plot for Moderate Impairment: Invalid shape (224, 224, 3, 4) for image data
2026-01-06 12:15:53,719 - INFO - Generating SHAP visualization for: No Impairment
2026-01-06 12:15:53,751 - INFO - Total absolute attribution for No Impairment: 5.7010e+03
2026-01-06 12:15:53,819 - INFO - Boosting SHAP values by factor: 48.92 (Max val: 2.0440e-02)
2026-01-06 12:15:54,241 - WARNING - Error creating SHAP plot for No Impairment: Invalid shape (224, 224, 3, 4) for image data
2026-01-06 12:15:54,244 - INFO - Generating SHAP visualization for: Very Mild Impairment
2026-01-06 12:15:54,274 - INFO - Total absolute attribution for Very Mild Impairment: 5.7010e+03
2026-01-06 12:15:54,337 - INFO - Boosting SHAP values by factor: 48.92 (Max val: 2.0440e-02)
2026-01-06 12:15:54,759 - WARNING - Error creating SHAP plot for Very Mild Impairment: Invalid shape (224, 224, 3, 4) for image data
2026-01-06 12:15:55,723 - INFO - SHAP analysis complete. Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis
2026-01-06 12:15:55,972 - INFO - 
================================================================================
2026-01-06 12:15:55,972 - INFO - ANALYSIS COMPLETE!
2026-01-06 12:15:55,976 - INFO - ================================================================================

2026-01-06 12:15:55,976 - INFO - All results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced

2026-01-06 12:15:55,977 - INFO - Generated Files:
2026-01-06 12:15:55,978 - INFO -   K-Fold Analysis:  C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-06 12:15:55,979 - INFO -   K-Fold Results:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-06 12:15:55,980 - INFO -   Ensemble Results: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-06 12:15:55,981 - INFO -   Grad-CAM++ Viz:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus/
2026-01-06 12:15:55,982 - INFO -   SHAP Analysis:    C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis/
2026-01-06 12:15:55,983 - INFO -   Trained Models:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models/
2026-01-06 12:15:55,984 - INFO - 
================================================================================

2026-01-06 13:30:17,859 - INFO - ================================================================================
2026-01-06 13:30:17,860 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-06 13:30:17,864 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-06 13:30:17,865 - INFO - ================================================================================
2026-01-06 13:30:17,865 - INFO - Configuration:
2026-01-06 13:30:17,866 - INFO -   • Image Size: 224x224
2026-01-06 13:30:17,867 - INFO -   • Batch Size: 32
2026-01-06 13:30:17,867 - INFO -   • K-Folds: 5
2026-01-06 13:30:17,868 - INFO -   • Epochs: 60
2026-01-06 13:30:17,982 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-06 13:30:17,983 - INFO - Random seeds set (Strict determinism disabled for GPU compatibility)
2026-01-06 13:30:17,985 - INFO - Starting K-Fold Cross-Validation...
2026-01-06 13:30:17,988 - INFO - 
================================================================================
2026-01-06 13:30:17,989 - INFO - Starting 5-Fold Cross-Validation
2026-01-06 13:30:17,990 - INFO - ================================================================================

2026-01-06 13:30:17,990 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-06 13:30:18,039 - INFO - Found 10240 images from 4 classes
2026-01-06 13:30:18,039 - INFO -   • Mild Impairment: 2560 images
2026-01-06 13:30:18,042 - INFO -   • Moderate Impairment: 2560 images
2026-01-06 13:30:18,042 - INFO -   • No Impairment: 2560 images
2026-01-06 13:30:18,043 - INFO -   • Very Mild Impairment: 2560 images
2026-01-06 13:30:18,049 - INFO - 
============================================================
2026-01-06 13:30:18,049 - INFO - Training Fold 1/5
2026-01-06 13:30:18,050 - INFO - ============================================================
2026-01-06 13:30:18,174 - INFO - Training samples: 8192
2026-01-06 13:30:18,174 - INFO - Validation samples: 2048
2026-01-06 13:30:18,179 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 13:30:18,180 - INFO - Building model architecture...
2026-01-06 13:30:21,036 - INFO - Model created with 188 layers
2026-01-06 13:30:21,038 - INFO - Trainable parameters: 25,305,860
2026-01-06 13:30:21,047 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 13:59:42,374 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 14:57:02,292 - INFO - 
Evaluating fold performance...
2026-01-06 14:57:08,082 - INFO - 
Fold 1 Results:
2026-01-06 14:57:08,082 - INFO -   • Accuracy:  0.9512
2026-01-06 14:57:08,086 - INFO -   • Precision: 0.9533
2026-01-06 14:57:08,087 - INFO -   • Recall:    0.9512
2026-01-06 14:57:08,088 - INFO -   • F1-Score:  0.9504
2026-01-06 14:57:08,089 - INFO -   • Kappa:     0.9349
2026-01-06 14:57:08,795 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-06 14:57:09,026 - INFO - 
============================================================
2026-01-06 14:57:09,027 - INFO - Training Fold 2/5
2026-01-06 14:57:09,030 - INFO - ============================================================
2026-01-06 14:57:09,197 - INFO - Training samples: 8192
2026-01-06 14:57:09,197 - INFO - Validation samples: 2048
2026-01-06 14:57:09,202 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 14:57:09,202 - INFO - Building model architecture...
2026-01-06 14:57:10,508 - INFO - Model created with 188 layers
2026-01-06 14:57:10,511 - INFO - Trainable parameters: 25,305,860
2026-01-06 14:57:10,520 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-06 15:25:53,494 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-06 16:22:00,480 - INFO - 
Evaluating fold performance...
2026-01-06 16:22:06,183 - INFO - 
Fold 2 Results:
2026-01-06 16:22:06,183 - INFO -   • Accuracy:  0.9453
2026-01-06 16:22:06,188 - INFO -   • Precision: 0.9470
2026-01-06 16:22:06,188 - INFO -   • Recall:    0.9453
2026-01-06 16:22:06,189 - INFO -   • F1-Score:  0.9448
2026-01-06 16:22:06,190 - INFO -   • Kappa:     0.9271
2026-01-06 16:22:06,844 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-06 16:22:07,265 - INFO - 
============================================================
2026-01-06 16:22:07,265 - INFO - Training Fold 3/5
2026-01-06 16:22:07,268 - INFO - ============================================================
2026-01-06 16:22:07,431 - INFO - Training samples: 8192
2026-01-06 16:22:07,431 - INFO - Validation samples: 2048
2026-01-06 16:22:07,433 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-06 16:22:07,438 - INFO - Building model architecture...
2026-01-06 16:22:08,734 - INFO - Model created with 188 layers
2026-01-06 16:22:08,738 - INFO - Trainable parameters: 25,305,860
2026-01-06 16:22:08,745 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-07 09:24:20,464 - INFO - ================================================================================
2026-01-07 09:24:20,464 - INFO - Memory-Efficient Alzheimer's Classification
2026-01-07 09:24:20,464 - INFO - K-Fold CV + Grad-CAM++ + SHAP Analysis
2026-01-07 09:24:20,464 - INFO - ================================================================================
2026-01-07 09:24:20,464 - INFO - Configuration:
2026-01-07 09:24:20,464 - INFO -   • Image Size: 224x224
2026-01-07 09:24:20,464 - INFO -   • Batch Size: 32
2026-01-07 09:24:20,464 - INFO -   • K-Folds: 5
2026-01-07 09:24:20,464 - INFO -   • Epochs: 60
2026-01-07 09:24:20,652 - INFO - GPU memory growth enabled for 2 GPU(s)
2026-01-07 09:24:20,652 - INFO - Random seeds set (Strict determinism disabled for GPU compatibility)
2026-01-07 09:24:20,652 - INFO - Starting K-Fold Cross-Validation...
2026-01-07 09:24:20,652 - INFO - 
================================================================================
2026-01-07 09:24:20,652 - INFO - Starting 5-Fold Cross-Validation
2026-01-07 09:24:20,652 - INFO - ================================================================================

2026-01-07 09:24:20,652 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\train
2026-01-07 09:24:20,917 - INFO - Found 10240 images from 4 classes
2026-01-07 09:24:20,917 - INFO -   • Mild Impairment: 2560 images
2026-01-07 09:24:20,917 - INFO -   • Moderate Impairment: 2560 images
2026-01-07 09:24:20,917 - INFO -   • No Impairment: 2560 images
2026-01-07 09:24:20,917 - INFO -   • Very Mild Impairment: 2560 images
2026-01-07 09:24:20,917 - INFO - 
============================================================
2026-01-07 09:24:20,917 - INFO - Training Fold 1/5
2026-01-07 09:24:20,917 - INFO - ============================================================
2026-01-07 09:24:21,058 - INFO - Training samples: 8192
2026-01-07 09:24:21,074 - INFO - Validation samples: 2048
2026-01-07 09:24:21,074 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-07 09:24:21,074 - INFO - Building model architecture...
2026-01-07 09:24:24,308 - INFO - Model created with 188 layers
2026-01-07 09:24:24,308 - INFO - Trainable parameters: 25,305,860
2026-01-07 09:24:24,324 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-07 09:53:11,875 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-07 11:00:56,849 - INFO - 
Evaluating fold performance...
2026-01-07 11:01:16,507 - INFO - 
Fold 1 Results:
2026-01-07 11:01:16,507 - INFO -   • Accuracy:  0.9517
2026-01-07 11:01:16,508 - INFO -   • Precision: 0.9547
2026-01-07 11:01:16,509 - INFO -   • Recall:    0.9517
2026-01-07 11:01:16,510 - INFO -   • F1-Score:  0.9509
2026-01-07 11:01:16,510 - INFO -   • Kappa:     0.9355
2026-01-07 11:01:19,869 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-07 11:01:20,315 - INFO - 
============================================================
2026-01-07 11:01:20,315 - INFO - Training Fold 2/5
2026-01-07 11:01:20,317 - INFO - ============================================================
2026-01-07 11:01:20,525 - INFO - Training samples: 8192
2026-01-07 11:01:20,526 - INFO - Validation samples: 2048
2026-01-07 11:01:20,530 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-07 11:01:20,531 - INFO - Building model architecture...
2026-01-07 11:01:27,055 - INFO - Model created with 188 layers
2026-01-07 11:01:27,057 - INFO - Trainable parameters: 25,305,860
2026-01-07 11:01:27,067 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-07 11:37:18,616 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-07 12:37:09,370 - INFO - 
Evaluating fold performance...
2026-01-07 12:37:15,073 - INFO - 
Fold 2 Results:
2026-01-07 12:37:15,074 - INFO -   • Accuracy:  0.9541
2026-01-07 12:37:15,076 - INFO -   • Precision: 0.9554
2026-01-07 12:37:15,077 - INFO -   • Recall:    0.9541
2026-01-07 12:37:15,078 - INFO -   • F1-Score:  0.9536
2026-01-07 12:37:15,079 - INFO -   • Kappa:     0.9388
2026-01-07 12:37:15,704 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_2.keras
2026-01-07 12:37:16,243 - INFO - 
============================================================
2026-01-07 12:37:16,243 - INFO - Training Fold 3/5
2026-01-07 12:37:16,247 - INFO - ============================================================
2026-01-07 12:37:16,410 - INFO - Training samples: 8192
2026-01-07 12:37:16,414 - INFO - Validation samples: 2048
2026-01-07 12:37:16,419 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-07 12:37:16,419 - INFO - Building model architecture...
2026-01-07 12:37:17,738 - INFO - Model created with 188 layers
2026-01-07 12:37:17,741 - INFO - Trainable parameters: 25,305,860
2026-01-07 12:37:17,754 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-07 13:07:06,487 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-07 14:11:38,284 - INFO - 
Evaluating fold performance...
2026-01-07 14:11:44,250 - INFO - 
Fold 3 Results:
2026-01-07 14:11:44,250 - INFO -   • Accuracy:  0.9629
2026-01-07 14:11:44,251 - INFO -   • Precision: 0.9635
2026-01-07 14:11:44,251 - INFO -   • Recall:    0.9629
2026-01-07 14:11:44,251 - INFO -   • F1-Score:  0.9627
2026-01-07 14:11:44,252 - INFO -   • Kappa:     0.9505
2026-01-07 14:11:44,891 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_3.keras
2026-01-07 14:11:45,905 - INFO - 
============================================================
2026-01-07 14:11:45,905 - INFO - Training Fold 4/5
2026-01-07 14:11:45,905 - INFO - ============================================================
2026-01-07 14:11:46,091 - INFO - Training samples: 8192
2026-01-07 14:11:46,091 - INFO - Validation samples: 2048
2026-01-07 14:11:46,094 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-07 14:11:46,094 - INFO - Building model architecture...
2026-01-07 14:11:47,710 - INFO - Model created with 188 layers
2026-01-07 14:11:47,713 - INFO - Trainable parameters: 25,305,860
2026-01-07 14:11:47,727 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-07 14:44:44,542 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-07 15:49:08,826 - INFO - 
Evaluating fold performance...
2026-01-07 15:49:14,499 - INFO - 
Fold 4 Results:
2026-01-07 15:49:14,499 - INFO -   • Accuracy:  0.9609
2026-01-07 15:49:14,500 - INFO -   • Precision: 0.9620
2026-01-07 15:49:14,501 - INFO -   • Recall:    0.9609
2026-01-07 15:49:14,501 - INFO -   • F1-Score:  0.9606
2026-01-07 15:49:14,501 - INFO -   • Kappa:     0.9479
2026-01-07 15:49:15,132 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_4.keras
2026-01-07 15:49:15,806 - INFO - 
============================================================
2026-01-07 15:49:15,807 - INFO - Training Fold 5/5
2026-01-07 15:49:15,807 - INFO - ============================================================
2026-01-07 15:49:15,980 - INFO - Training samples: 8192
2026-01-07 15:49:15,980 - INFO - Validation samples: 2048
2026-01-07 15:49:15,983 - INFO - Class weights: {0: 1.0, 1: 1.0, 2: 1.0, 3: 1.0}
2026-01-07 15:49:15,983 - INFO - Building model architecture...
2026-01-07 15:49:17,309 - INFO - Model created with 188 layers
2026-01-07 15:49:17,312 - INFO - Trainable parameters: 25,305,860
2026-01-07 15:49:17,326 - INFO - 
Phase 1: Training classification head (frozen backbone)...
2026-01-07 16:20:46,373 - INFO - 
Phase 2: Fine-tuning entire model...
2026-01-07 17:21:39,523 - INFO - 
Evaluating fold performance...
2026-01-07 17:21:45,220 - INFO - 
Fold 5 Results:
2026-01-07 17:21:45,220 - INFO -   • Accuracy:  0.9473
2026-01-07 17:21:45,220 - INFO -   • Precision: 0.9496
2026-01-07 17:21:45,220 - INFO -   • Recall:    0.9473
2026-01-07 17:21:45,220 - INFO -   • F1-Score:  0.9462
2026-01-07 17:21:45,220 - INFO -   • Kappa:     0.9297
2026-01-07 17:21:45,872 - INFO - Model saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_5.keras
2026-01-07 17:21:46,411 - INFO - 
============================================================
2026-01-07 17:21:46,411 - INFO - K-Fold Cross-Validation Summary
2026-01-07 17:21:46,411 - INFO - ============================================================
2026-01-07 17:21:46,411 - INFO - Average Accuracy:  0.9554 ± 0.0058
2026-01-07 17:21:46,411 - INFO - Average Precision: 0.9570
2026-01-07 17:21:46,411 - INFO - Average Recall:    0.9554
2026-01-07 17:21:46,411 - INFO - Average F1-Score:  0.9548 ± 0.0061
2026-01-07 17:21:46,411 - INFO - Average Kappa:     0.9405
2026-01-07 17:21:46,411 - INFO - Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-07 17:21:46,411 - INFO - Generating K-Fold visualization plots...
2026-01-07 17:21:47,788 - INFO - K-fold analysis plot saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-07 17:21:47,810 - INFO - 
================================================================================
2026-01-07 17:21:47,810 - INFO - Evaluating on Test Set
2026-01-07 17:21:47,810 - INFO - ================================================================================

2026-01-07 17:21:47,982 - INFO - 
============================================================
2026-01-07 17:21:47,982 - INFO - Making Ensemble Predictions
2026-01-07 17:21:47,982 - INFO - ============================================================
2026-01-07 17:21:47,982 - INFO - Combining predictions from 5 models...
2026-01-07 17:21:47,982 - INFO - Loading model 1/5: model_fold_1.keras
2026-01-07 17:21:55,091 - INFO -   Predictions shape: (1183, 4)
2026-01-07 17:21:55,509 - INFO - Loading model 2/5: model_fold_2.keras
2026-01-07 17:22:02,188 - INFO -   Predictions shape: (1183, 4)
2026-01-07 17:22:02,344 - INFO - Loading model 3/5: model_fold_3.keras
2026-01-07 17:22:08,215 - INFO -   Predictions shape: (1183, 4)
2026-01-07 17:22:08,371 - INFO - Loading model 4/5: model_fold_4.keras
2026-01-07 17:22:14,341 - INFO -   Predictions shape: (1183, 4)
2026-01-07 17:22:14,505 - INFO - Loading model 5/5: model_fold_5.keras
2026-01-07 17:22:20,543 - INFO -   Predictions shape: (1183, 4)
2026-01-07 17:22:20,715 - INFO - Ensemble prediction shape: (1183, 4)
2026-01-07 17:22:20,715 - INFO - 
============================================================
2026-01-07 17:22:20,715 - INFO - ENSEMBLE TEST RESULTS
2026-01-07 17:22:20,715 - INFO - ============================================================
2026-01-07 17:22:20,715 - INFO - Accuracy:          0.9552 (95.52%)
2026-01-07 17:22:20,715 - INFO - Precision (Macro): 0.9583
2026-01-07 17:22:20,715 - INFO - Recall (Macro):    0.9660
2026-01-07 17:22:20,715 - INFO - F1-Score (Macro):  0.9609
2026-01-07 17:22:20,731 - INFO - Cohen's Kappa:     0.9193
2026-01-07 17:22:20,731 - INFO - MCC:               0.9215
2026-01-07 17:22:20,746 - INFO - 
                      precision    recall  f1-score   support

     Mild Impairment       0.90      0.98      0.94        83
 Moderate Impairment       1.00      1.00      1.00        12
       No Impairment       0.94      1.00      0.97       640
Very Mild Impairment       1.00      0.89      0.94       448

            accuracy                           0.96      1183
           macro avg       0.96      0.97      0.96      1183
        weighted avg       0.96      0.96      0.95      1183

2026-01-07 17:22:20,746 - INFO - Metrics saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-07 17:22:21,459 - INFO - Confusion matrix saved: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\confusion_matrix_ensemble.png
2026-01-07 17:22:21,459 - INFO - 
================================================================================
2026-01-07 17:22:21,459 - INFO - Generating Grad-CAM++ Visualizations
2026-01-07 17:22:21,459 - INFO - ================================================================================

2026-01-07 17:22:23,453 - INFO - Processing 3 images for class: Mild Impairment
2026-01-07 17:22:27,922 - INFO - Processing 3 images for class: Moderate Impairment
2026-01-07 17:22:30,846 - INFO - Processing 3 images for class: No Impairment
2026-01-07 17:22:33,534 - INFO - Processing 3 images for class: Very Mild Impairment
2026-01-07 17:22:36,261 - INFO - Grad-CAM++ visualizations saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus
2026-01-07 17:22:36,480 - INFO - 
================================================================================
2026-01-07 17:22:36,480 - INFO - Starting SHAP Analysis
2026-01-07 17:22:36,480 - INFO - ================================================================================

2026-01-07 17:22:36,480 - INFO - 
============================================================
2026-01-07 17:22:36,480 - INFO - Starting SHAP Analysis
2026-01-07 17:22:36,496 - INFO - ============================================================
2026-01-07 17:22:36,496 - INFO - Loading model from: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models\model_fold_1.keras
2026-01-07 17:22:39,996 - INFO - Created logits model (softmax replaced with linear activation)
2026-01-07 17:22:39,996 - INFO - Collecting file paths from: C:\Users\Lab1\Desktop\Alzhimer\Combined Dataset\test
2026-01-07 17:22:39,996 - INFO - Found 1183 images from 4 classes
2026-01-07 17:22:39,996 - INFO -   • Mild Impairment: 83 images
2026-01-07 17:22:39,996 - INFO -   • Moderate Impairment: 12 images
2026-01-07 17:22:39,996 - INFO -   • No Impairment: 640 images
2026-01-07 17:22:40,011 - INFO -   • Very Mild Impairment: 448 images
2026-01-07 17:22:40,020 - INFO - Loading 50 background samples...
2026-01-07 17:22:40,099 - INFO - Loaded 50 background samples
2026-01-07 17:22:40,099 - INFO - Loading 10 test samples...
2026-01-07 17:22:40,114 - INFO - Loaded 10 test samples
2026-01-07 17:22:40,114 - INFO - Creating SHAP GradientExplainer...
2026-01-07 17:22:40,114 - INFO - Calculating SHAP values...
2026-01-07 17:23:34,125 - INFO - SHAP Values Type: <class 'numpy.ndarray'>
2026-01-07 17:23:34,125 - INFO - SHAP Values Shape: (10, 224, 224, 3, 4)
2026-01-07 17:23:34,125 - INFO - Test Samples Display Shape: (10, 224, 224, 3)
2026-01-07 17:23:34,140 - INFO - Generating SHAP visualization for: Mild Impairment
2026-01-07 17:23:34,156 - INFO - Total absolute attribution for Mild Impairment: 9.9398e+03
2026-01-07 17:23:34,223 - INFO - Boosting SHAP values by factor: 25.19 (Max val: 3.9701e-02)
2026-01-07 17:23:34,628 - WARNING - Error creating SHAP plot for Mild Impairment: Invalid shape (224, 224, 3, 4) for image data
2026-01-07 17:23:34,628 - INFO - Generating SHAP visualization for: Moderate Impairment
2026-01-07 17:23:34,675 - INFO - Total absolute attribution for Moderate Impairment: 9.9398e+03
2026-01-07 17:23:34,722 - INFO - Boosting SHAP values by factor: 25.19 (Max val: 3.9701e-02)
2026-01-07 17:23:35,097 - WARNING - Error creating SHAP plot for Moderate Impairment: Invalid shape (224, 224, 3, 4) for image data
2026-01-07 17:23:35,097 - INFO - Generating SHAP visualization for: No Impairment
2026-01-07 17:23:35,128 - INFO - Total absolute attribution for No Impairment: 9.9398e+03
2026-01-07 17:23:35,191 - INFO - Boosting SHAP values by factor: 25.19 (Max val: 3.9701e-02)
2026-01-07 17:23:35,566 - WARNING - Error creating SHAP plot for No Impairment: Invalid shape (224, 224, 3, 4) for image data
2026-01-07 17:23:35,566 - INFO - Generating SHAP visualization for: Very Mild Impairment
2026-01-07 17:23:35,597 - INFO - Total absolute attribution for Very Mild Impairment: 9.9398e+03
2026-01-07 17:23:35,660 - INFO - Boosting SHAP values by factor: 25.19 (Max val: 3.9701e-02)
2026-01-07 17:23:36,042 - WARNING - Error creating SHAP plot for Very Mild Impairment: Invalid shape (224, 224, 3, 4) for image data
2026-01-07 17:23:36,862 - INFO - SHAP analysis complete. Results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis
2026-01-07 17:23:37,078 - INFO - 
================================================================================
2026-01-07 17:23:37,078 - INFO - ANALYSIS COMPLETE!
2026-01-07 17:23:37,094 - INFO - ================================================================================

2026-01-07 17:23:37,094 - INFO - All results saved to: C:\Users\Lab1\Desktop\Alzhimer\results_advanced

2026-01-07 17:23:37,094 - INFO - Generated Files:
2026-01-07 17:23:37,094 - INFO -   K-Fold Analysis:  C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_analysis.png
2026-01-07 17:23:37,094 - INFO -   K-Fold Results:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\kfold_results.json
2026-01-07 17:23:37,094 - INFO -   Ensemble Results: C:\Users\Lab1\Desktop\Alzhimer\results_advanced\metrics\ensemble_results.json
2026-01-07 17:23:37,094 - INFO -   Grad-CAM++ Viz:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\gradcam_plus_plus/
2026-01-07 17:23:37,094 - INFO -   SHAP Analysis:    C:\Users\Lab1\Desktop\Alzhimer\results_advanced\shap_analysis/
2026-01-07 17:23:37,094 - INFO -   Trained Models:   C:\Users\Lab1\Desktop\Alzhimer\results_advanced\models/
2026-01-07 17:23:37,094 - INFO - 
================================================================================

